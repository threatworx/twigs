{
    "ACCT-2754": "<p><div class=\"sp\">Process accounting is a method to track system resources. It includes a way to monitor system resources and how these resources are used for the users on the system. On FreeBSD accounting can be enabled to track these resources.</div></p><br><p><div class=\"sp\">See shell snippet to enable process account. Make sure to monitor disk usage on the related disk partition.</div></p><br>",
    "ACCT-9622": "<p><div class=\"sp\">Process accounting is a method to track system resources. It includes a way to monitor system resources and how these resources are used for the users on the system. On Linux systems, process accounting can be enabled to track these resources.</div></p><br><p><div class=\"sp\">See shell snippet to enable process account. Make sure to monitor disk usage on the related disk partition. <br><br>ac: statistics about users (uses wtmp file)<br>accton: turn process accounting on/off<br>sa: provides accounting information summarization. Includes previously executed commands, I/O operation times, CPU times.<br>lastcomm: displays previously executed commands<br></div></p><br>",
    "ACCT-9626": "<p><div class=\"sp\">Sysstat collects system information</div></p><br><p><div class=\"sp\"><p>Install the sysstat package to obtain the supporting tools</p><h3>Tools</h3><li>sar: collects and also reports about system activity information</li><li>iostat: reports CPU utilization and disk I/O stats</li><li>mpstat: reports global and processor stats</li><li>pidstat: reports statistics for Linux processes</li><li>sadf: displays data collected by sar</li></div></p><br>",
    "ACCT-9628": "<p><div class=\"sp\">For Linux systems the Linux audit daemon can audit files and processes. This control checks for the status of the audit daemon. Suspicious changes or activities will trigger an event to be logged by the audit daemon.</div></p><br><p><div class=\"sp\"><p>The Linux Audit Framework is a CAPP-compliant (Controlled Access Protection Profiles) auditing system. Support for the framework is usually enabled in Linux distributions and helps with monitoring events. Such events can range from changing the time, using specific system calls, or making changes to important files.</p><p>Every system has it own goal and data to protect. Depending on the confidentiality, the audit framework can help with monitoring expected and unexpected changes. It might be powerful in detecting any system intrusion, or monitoring the system integrity.</p><p>As the Linux audit framework has not a single good configuration, we have added more details to our Enterprise offering. If you need this service for your business systems, consider upgrading to the Enterprise version.</p></div></p><br>",
    "ACCT-9630": "<p><div class=\"sp\">This control checks for an empty ruleset of the Linux audit daemon.</div></p><br><p><div class=\"sp\">When the audit daemon is installed, the next step is configuring the daemon. The configuration is stored in /etc/audit/audit.rules and defines what should be audited.</div></p><br>",
    "ACCT-9632": "<p><div class=\"sp\">The Linux audit framework consists of an audit daemon (auditd), utilities, audit rules and a configuration file for the daemon. This file (auditd.conf) is generally located in the /etc/audit directory or similar. Lynis tries to determine where this file is located. If this control shows up, the location could not be discovered. This is unusual, as the binaries of the framework are present and the audit daemon is running.</div></p><br><p><div class=\"sp\">Perform a manual search for the auditd.conf file. In case it's on an alternative location and Lynis can't find it, please report this finding to our development team.</div></p><br>",
    "ACCT-9636": "<p><div class=\"sp\">This control checks if the Snoopy library can be found, which is a wrapper around execve() and logger. By implementing Snoopy an audit trail can be created by logging all executed commands.</div></p><br><p><div class=\"sp\">Install Snoopy to log all executed commands to the authpriv (usually /var/log/auth.log)</div></p><br>",
    "AUTH-9204": "<p><div class=\"sp\">While allowed, usually configuration of multiple users with an ID of zero (0) is bad practice. Better is to create separated accounts and use proper group membership.</div></p><br>",
    "AUTH-9208": "<p><div class=\"sp\">Lynis checks for any duplicates by checking the passwd file and count them. Any ID which shows up more than a single time is reported as a finding. Accounts and user IDs should be unique to enable proper accounting. Using several accounts with the same ID may result in data loss.</div></p><br><p><div class=\"sp\">Check for duplicate IDs (see shell script) and remove a duplicate, or give the second user a new ID.</div></p><br>",
    "AUTH-9216": "<p><div class=\"sp\">The password and group files (and their shadow equivalents) are an important part in the authentication process. Also the security controls like access control and file permissions are impacted by proper authentication and accounting of users.  Inconsistencies in the password file can be caused by malicious activities or in some cases due to improper usage of tools, like a file editor. Inconsistencies should therefore be checked and fixed.</div></p><br><p><div class=\"sp\">Run a tool like grpck to detect issues in password and group files. See the man page on your platform, before running this command. Our advice is to check first in read-only mode, before applying any changes. This way the cause can be determined, why inconsistencies showed up in the first place.</div></p><br>",
    "AUTH-9218": "<p><div class=\"sp\">Lynis checks for users accounts and which ones do not have a password. Accounts without a password are considered to be a bad practice, as each user should prove he or she is the rightful owner of the account. Lacking a password may give more than 1 authorized user access to the account and therefore seriously impact proper accounting. Loss of data or impact to the integrity of data may be the result of lacking passwords.</div></p><br><p><div class=\"sp\">Check each account which shows up without a password. Determine why this is the case and if the account is actually being used. If not, disable the account. If the account is used, determine who is using it. Determine a remediation plan to define a password and test functionality of the account and system, to prevent business processes suddenly failing. For example, the account may be used in shell scripts or configured in other software components.</div></p><br>",
    "AUTH-9222": "<p><div class=\"sp\">Groups should be unique to ensure each user has the appropriate permissions.</div></p><br><p><div class=\"sp\">Perform a check on your group files (/etc/group and /etc/gshadow) for any double group references. Usually this indicates a typo or incorrect usage of group IDs.</div></p><br>",
    "AUTH-9228": "<p><div class=\"sp\">Password files like /etc/passwd and /etc/shadow should be checked on a regular basis to see if any errors are present.</div></p><br><p><div class=\"sp\">Run pwck and grpck to check password and group files. Any issues found can be solved by running vipw and vigr.</div></p><br>",
    "AUTH-9262": "<p><div class=\"sp\">Several modules within the PAM framework can help restricting access to facilities to only authorized people, including limitations as a strong password, the right console, or the right software.<br><br>Passwords should be protected and strengthened where possible. On Unix and Linux based systems this is usually done via PAM modules and the related configuration files. Examples include tools like passwdqc (password quality control) and cracklib (password cracking library).</div></p><br><p><div class=\"sp\">Install a PAM module like passwdqc or cracklib.</div></p><br>",
    "AUTH-9282": "<p><div class=\"sp\">Passwords are the main key to access an account, related services and information. Therefore they need to be protected via means of a strong password and password expiry. This particular test found passwords without an expire date. Depending on the sensitivity of the information on this machine, check if this appropriate and according to the security policy.</div></p><br>",
    "AUTH-9283": "<p><div class=\"sp\">Passwords are the main key to access an account, related services and information. Therefore they need to be protected via means of a strong password and password expiry. This particular test found accounts without a password. Depending on the sensitivity of the information on this machine, check if this appropriate and according to the security policy.</div></p><br>",
    "AUTH-9286": "<p><div class=\"sp\">Proper protection against weak passwords and regular changes, limits the risk of cracking passwords or being obtained by unauthorized people.</div></p><br><p><div class=\"sp\"><p>Passwords are a key component to authenticate users to Linux systems. Passwords need to be of a good quality, to prevent so-called brute-forcing attacks. In such case, easy passwords can be quickly guessed, resulting in a possible intrusion. The strength of passwords is determined by the length and variety of characters, including capitals, numbers, and special characters.</p><p>Besides the strength, it is good to use password aging. This means a password can only be used for a specific duration of time before the user has to change it again. This enforces them to change it on a regular basis, having hopefully a bigger variety in passwords used on the system and other services.</p><p>Password aging is not always needed on the Linux system itself. For example, when using two-factor authentication, central authentication with LDAP or Radius.</p><p>For Lynis Enterprise users we have additional tests regarding authentication and passwords. Consider upgrading if password strength and aging are important aspects for your environment.</p></div></p><br>",
    "AUTH-9288": "<p><div class=\"sp\">Some accounts have been found with an expired password.</div></p><br><p><div class=\"sp\">Determine which accounts have their account expired by reviewing the lynis.log. Then make a decision to remove any accounts that are no longer being used.</div></p><br>",
    "AUTH-9308": "<p><div class=\"sp\">Physical access to the machine can be used to load alternative software or a different operating system, during the boot phase. Configure a password in the boot loader to prevent this risk. This test applies to Linux based systems only.</div></p><br><p><div class=\"sp\"><p>For emergency maintenance and password recovery, single user mode is used on Linux systems. In such an event, the system can run a limited set of commands, and has limited access to system resources. However, this is enough to reset a root password, or try mounting a previously failed file system mount.</p><p>While single user mode is great for system engineers to performance emergency maintenance activities, it can also be abused by evildoers with access to the system. For that reason single user mode should be as limited as possible. The more sensitive data, the higher the restricted access to this feature.</p><p>Single user mode on Linux is protected in different ways. It depends on which service manager. For distributions using systemd, have a look at the related targets like rescue, console-shell, and emergency.</p><h2>Related files</h2><ul><li>/usr/lib/systemd/system/emergency.target</li><li>/usr/lib/systemd/system/rescue.target</li></ul></div></p><br>",
    "AUTH-9328": "<p><div class=\"sp\">The umask defines what default file permissions will be applied on a file or directory. Usually servers can have a more strict umask like 027, where desktops may be less strict (022).</div></p><br><p><div class=\"sp\"><p>Files and directories are created with a default set of permissions. These depend on the parent directory and the umask value. This umask value contains three or four numbers and gives the system a hint on how to create new objects on the file system. For example using the umask 027 will be translated into 750 for directories or 640 for files. This means that the <em>owner</em> can read and write, with additional execution rights for directories. This latter part means that you are allowed to traverse the directory. The <em>group</em> will get read permissions for files, and again execution rights for directories. The <em>other</em> won't get any access to the file.</p><p>Using the right umask helps with limiting who can access created files. This is especially important for systems with multiple users. This is also the case when loose file permissions can result in unauthorized information disclosure, like a web server.</p></div></p><br>",
    "BANN-7122": "<p><div class=\"sp\">Authorized and unauthorized users should know that the system is monitored and deter unauthorized users from attempting to log in.</div></p><br><p><div class=\"sp\">Define a banner text to inform both authorized and unauthorized users about the machine and service they are about to access. The purpose is to share your policy before an access attempt is being made. Users should know that there privacy might be invaded, due to monitoring of the system and its resources, to protect the integrity of the system. Also unauthorized users should be deterred from trying to access it in the first place.<br><br>Do not reveal sensitive information, like the specific goal of the machine, or what can be found on it. Consult with your legal department, to determine appropriate text.</div></p><br>",
    "BANN-7126": "<p><div class=\"sp\">Make users aware that systems are monitored and their privacy might be limited, if required by legal requirements or law. Add a banner to /etc/issue to warn users.</div></p><br><p><div class=\"sp\">Add a legal disclaimer in your /etc/issue file. Consult a legal contact person within your company, or use a predefined version.</div></p><br>",
    "BANN-7130": "<p><div class=\"sp\">Make users aware that systems are monitored and their privacy might be limited, if required by legal requirements or law. Add a banner to /etc/issue.net to warn users.</div></p><br><p><div class=\"sp\">Add a legal disclaimer in your /etc/issue.net file. Consult a legal contact person within your company, or use a predefined version.</div></p><br>",
    "BOOT-5121": "<p><div class=\"sp\">Check if GRUB boot loader exists</div></p><br><p><div class=\"sp\">No actions needed.</div></p><br>",
    "BOOT-5122": "<p><div class=\"sp\">By default anyone with physical access to the machine can load alternative software or another operating system during the boot phase. Configure a password in grub to prevent this possibility.</div></p><br><p><div class=\"sp\"><p>The boot loader is started at the beginning of the boot cycle, and enables the user to select what operating system to start. Normally one entry is selected as default, with a timer of a few seconds. When this timer expires, this default entry is selected, trigger the start of the related operating system.</p><p>Often the boot loader contains the primary operating system and several fallback options. The same operating system with a previous Linux kernel version is a common option to see in such configuration. Another option is a rescue image, to perform emergency maintenance when the system does not longer boot.</p><p>Although a rescue option or fallback version are great during emergency, they can become a weakness. Evildoers with physical access to the system could use this option to reset the root password. Especially for notebooks this is a risk, as it is common that people are in the physical presence of such device. When hosting systems in a shared data center, this could also be a situation in which it makes sense to set a password on the boot loader.</p></div></p><br>",
    "BOOT-5139": "<p><div class=\"sp\">By default anyone with physical access to the machine can load alternative software or another operating system during the boot phase. Configure a password in LILO to prevent this possibility.</div></p><br>",
    "BOOT-5180": "<p><div class=\"sp\">Lynis determines what services are started during runlevel 2 (boot). All boot services should be equal to the ones running, with the exception of the \"one-time\" processes. The latter group are processes which need a task to perform during or just after booting, like checking the file system. For all others it's common to be equal: if MySQL is running now, it is likely to be found in the boot services scripts as well.<br><br>Missing processes in the boot list may lead to unavailability of important services after a reboot. Regular testing and reboots help in determining any missing services.</div></p><br><p><div class=\"sp\">Check the scripts manually with the shell script. Determine what services are missing after comparing them with the running process list (ps -ef).</div></p><br>",
    "BOOT-5184": "<p><div class=\"sp\">Unix based systems have an extensive boot process, from loading the bootloader up to the execution of post-boot scripts. Protecting the boot process is important for the integrity of the system.<br><br>Start-up scripts define what services will be initialized and started during the boot process. Lynis tests if there are scripts with world writable permissions. These files can be changed by all users on the system and usually started with root permissions. Therefore they impose a risk to the system, as one might include a backdoor into a start-up script.</div></p><br><p><div class=\"sp\">Check the Lynis log file for the discovered files and adjust their permissions. Usually limiting the file permissions to just the root user will be sufficient.</div></p><br>",
    "BOOT-5260": "<p><div class=\"sp\">Systemd has a single user mode, named rescue.service. Similar to normal single user mode, it allows access to the system and bypass several levels of authorization. To protect against this, reconfigure the service with the sulogin option.</div></p><br><p><div class=\"sp\">Change your rescue.service file (/usr/lib/systemd/system/rescue.service) and define sulogin.<br>ExecStart=-/usr/sbin/sulogin<br><br>Note: ensure that it is linking to the right sulogin binary, which can change between distributions.</div></p><br>",
    "CONT-8104": "<p><div class=\"sp\">Docker should preferably run without any warnings.</div></p><br><p><div class=\"sp\">Run 'docker info' to see why this particular control shows up. If the warning(s) is accepted, add this control to the list of ignored controls.</div></p><br>",
    "CONT-8107": "<p><div class=\"sp\">This Lynis test determines the number of containers that are stopped.</div></p><br><p><div class=\"sp\">Generic advice is to reduce the number of unused containers. Containers that are stopped can be one sign for unused resources within the container administration.</div></p><br>",
    "CRYP-7902": "<p><div class=\"sp\">Certificates have a begin and end date configured to prevent misuse of expired certificates.</div></p><br>",
    "DBS-1816": "<p><div class=\"sp\">No password has been set for MySQL 'root' user</div></p><br><p><div class=\"sp\">Define a password, to prevent that unauthorized users can log in as 'root' on MySQL instances.</div></p><br>",
    "DBS-1820": "<p><div class=\"sp\">This control is displayed when no configured authorization mechanism was found on MongoDB.</div></p><br><p><div class=\"sp\">Usually the default permissions of MongoDB are restricted to the local machine and no authorization is needed. If the related MongoDB instance contains sensitive data, it means that without any form of authentication this data can be extracted. It is even more problematic when the instance is remotely available. During the last years this resulted in ransomware that keeps data in MongoDB instances hostage.<br><br>Set the authorization setting to require authentication and define the authorization level (which user can access a particular database).</div></p><br>",
    "DBS-1882": "<p><div class=\"sp\">This Lynis control tests for file permissions of the Redis configuration file.</div></p><br><p><div class=\"sp\">Check the file permissions of your Redis configuration file.</div></p><br>",
    "DBS-1884": "<p><div class=\"sp\">Require a password for Redis instances to prevent unauthorized connections from connecting to your Redis instances.</div></p><br><p><div class=\"sp\">Set the 'requirepass' setting in redis.conf.</div></p><br>",
    "DBS-1886": "<p><div class=\"sp\">By default the CONFIG command can be used. To prevent users from using this command, it can be disabled or renamed for an additional level of security.</div></p><br><p><div class=\"sp\">Use the 'rename-command CONFIG' setting for Redis to harden your configuration. You might need to apply this to multiple Redis configurations if several instances are running on it.</div></p><br>",
    "DBS-1888": "<p><div class=\"sp\">This test determines if the 'bind' setting has been configured to listen on the localhost.</div></p><br><p><div class=\"sp\">When possible, bind services to the localhost interface so that they are only available on the system itself. If this Redis instance needs to be accessible from the network, then consider configuring strict firewall rules and disable the test.</div></p><br>",
    "DEB-0280": "<p><div class=\"sp\">Invalid test</div></p><br><p><div class=\"sp\">This test is part of an unoffical set of patches. This version of Lynis might be outdated and therefore it is suggested to get a newer release. If you are on a system which does not provide the latest version, then you upgrade easily with packages from the <a href=\"https://packages.cisofy.com\">Lynis software repository</a>.</div></p><br>",
    "DEB-0285": "<p><div class=\"sp\">Invalid test</div></p><br><p><div class=\"sp\">This test is part of an unoffical set of patches. This version of Lynis might be outdated and therefore it is suggested to get a newer release. If you are on a system which does not provide the latest version, then you upgrade easily with packages from the <a href=\"https://packages.cisofy.com\">Lynis software repository</a>.</div></p><br>",
    "DEB-0520": "<p><div class=\"sp\">Invalid test</div></p><br><p><div class=\"sp\">This test is part of an unoffical set of patches. This version of Lynis might be outdated and therefore it is suggested to get a newer release. If you are on a system which does not provide the latest version, then you upgrade easily with packages from the <a href=\"https://packages.cisofy.com\">Lynis software repository</a>.</div></p><br>",
    "DEB-0870": "<p><div class=\"sp\">Invalid test</div></p><br><p><div class=\"sp\">This test is part of an unoffical set of patches. This version of Lynis might be outdated and therefore it is suggested to get a newer release. If you are on a system which does not provide the latest version, then you upgrade easily with packages from the <a href=\"https://packages.cisofy.com\">Lynis software repository</a>.</div></p><br>",
    "DEB-0880": "<p><div class=\"sp\">Invalid test</div></p><br><p><div class=\"sp\">This test is part of an unoffical set of patches. This version of Lynis might be outdated and therefore it is suggested to get a newer release. If you are on a system which does not provide the latest version, then you upgrade easily with packages from the <a href=\"https://packages.cisofy.com\">Lynis software repository</a>.</div></p><br>",
    "FILE-6310": "<p><div class=\"sp\">Some partitions like /tmp and /home can be easily filled by users of a system. When not being separated from the root file system, this might increase the risk of filling up this file system and cause malfunctioning to other system components.</div></p><br>",
    "FILE-6332": "<p><div class=\"sp\">This control checks if there is a swap partition configured in /etc/fstab. Usually it should be there, depending on how the system has been configured.</div></p><br><p><div class=\"sp\">Check your /etc/fstab file for any line with \"sw\" or \"swap\" to determine if there is a swap partition at all. On Linux systems more details can be extracted by displaying the contents of /proc/swaps.</div></p><br>",
    "FILE-6336": "<p><div class=\"sp\">The /etc/fstab file determines the available mount points for your system. This particular test looks for a swap partition and determines if there is any unexpected mount parameter used for these kind of partitions.</div></p><br><p><div class=\"sp\">This test requires a manual check up of your /etc/fstab file to determine what mounting options are used for your swap partition. If you need any help, let us know.</div></p><br>",
    "FILE-6344": "<p><div class=\"sp\">The pseudo file system /proc reveals a process data for all users. Especially in shared environments, or where multiple users have access, this is a security risk. Even for a basic web server it may help restricting who can see process data in /proc, to prevent possible information leakage.</div></p><br><p><div class=\"sp\">Change the hidepid mount option on /proc.</div></p><br>",
    "FILE-6354": "<p><div class=\"sp\">Lynis tests for the presence of old files in /tmp, as these files might be filling up space without any reason. Secondly to prevent file systems running out of space, or be used as permanent storage. Also malware is commonly found in /tmp, as a temporary staging place.</div></p><br>",
    "FILE-6362": "<p><div class=\"sp\">Check if a sticky bit is set on /tmp</div></p><br><p><div class=\"sp\">If your system has a separate /tmp directory, configure it with a sticky bit. This ensures that users only can alter their own data in this shared pool of files.</div></p><br>",
    "FILE-6410": "<p><div class=\"sp\">When locate has been found, Lynis checks for the related database.</div></p><br>",
    "FILE-7524": "<p><div class=\"sp\">This control describes the expected file permissions as configured in the profile. Depending on the tested files and related result, determine why a different permission set is being used, or correct it where appropriate.</div></p><br>",
    "FINT-4315": "<p><div class=\"sp\">AIDE configuration errors were found</div></p><br><p><div class=\"sp\">The current configuration of AIDE has one or more errors. Check the configuration file and use the related snippet.</div></p><br>",
    "FINT-4350": "<p><div class=\"sp\">To monitor for unauthorized changes, a file integrity tool can help with the detection of such event. Each time the contents or the properties of a file change, it will have a different checksum. With regular checks of the related integrity database, discovering changes becomes easy.Install a tool like AIDE, Samhain or Tripwire to monitor important system and data files. Additionally configure the tool to alert system or security personnel on events.</div></p><br><p><div class=\"sp\"><p>Install a tool like AIDE to help monitoring file changes. Good monitoring will ensure that both authorized changes are properly documented, and unauthorized changes are detected early.</p><p>Tip: when possible, link events to a (security) monitoring system, or your ITIL problem management. Especially unauthorized changes need a root cause analysis, or trigger incident response.</p></div></p><br>",
    "FINT-4402": "<p><div class=\"sp\">This check found that SHA256 or SHA512 were not used to create hashes of files.</div></p><br><p><div class=\"sp\">Consider using strong hashing algorithms in your AIDE configuration. MD5 and SHA1 are considered fairly weak, and hash collisions might result. This means that two different files end up in displaying the same hash. As AIDE has the focus on monitoring file integrity, strong algorithms should be used.</div></p><br>",
    "FIRE-4512": "<p><div class=\"sp\">Lynis checks for the availability of IPtables, but also if the ruleset is not empty. This might indicate bad configuration or a missing ruleset on the system.</div></p><br><p><div class=\"sp\">Usually this control shows up when the iptables module is loaded, while there no firewall rules loaded. Consider turning off the firewall software completely, or preferably populate it with an appropriate firewall policy.</div></p><br>",
    "FIRE-4513": "<p><div class=\"sp\">This control checks what iptables rules are currently not being used. Proper maintenance of firewall rules is essential for accuracy and proper network traffic filtering. Regular checks on the proper working and rule-sets help in limiting traffic to the bare minimum and decrease general risk of unauthorized connections.<br><br>Note: Some rules might have no hits, while still being applicable. Before removing rules, make sure that the time to monitor is long enough.</div></p><br><p><div class=\"sp\">Use iptables --list --numeric --verbose to display all rules. Check for rules which didn't get a hit and repeat this process several times (e.g. in a few weeks). Finally remove any unneeded rules.</div></p><br>",
    "FIRE-4520": "<p><div class=\"sp\">Lynis uses the built-in check of pf to determine if the configuration has any warnings. When the utility shows any, Lynis will trigger this control.</div></p><br><p><div class=\"sp\">Run pfctl in verbose mode (-vvv) and the -n option to check your configuration file. More extensive tests can be done with the Lynis Enterprise plugins and interface.</div></p><br>",
    "FIRE-4590": "<p><div class=\"sp\">Depending on the type of system and sensitivity of the data being stored and processed, a firewall is advised.</div></p><br>",
    "GEN-0010": "<p><div class=\"sp\">The operating system is end-of-life and does no longer receive updates</div></p><br><p><div class=\"sp\">Lynis detected that the operating system has reached its end-of-life. The vendor of the operating system does no longer provide updates. This means that newly discovered vulnerabilities or security issues can't be patched using a normal software update.<br><br>The suggested action is to upgrade the system or deploy a new system and migrate the software and data.</div></p><br>",
    "GEN-0020": "<p><div class=\"sp\">Your profile contains one or more lines that are in the old configuration format (key:value).</div></p><br><p><div class=\"sp\">Use the command displayed on the screen output to find relevant entries. Then convert them to the new format style (key=value). The default profile (default.prf) can be used as a reference. See 'lynis show profiles' for its exact location.</div></p><br>",
    "HRDN-7220": "<p><div class=\"sp\">Compilers are usually not needed on production systems, unless the upgrade mechanism of the particular system uses the source code of a package and compiles it into an executable form. Leaving compilers accessible to all users increases the risk of abuse or give attackers additional leverage when finding other flaws. One example is privilege escalation, by compiling and execution a discovered weakness in an existing system component.</div></p><br><p><div class=\"sp\">Limit access to compilers and remove them if no longer needed. <br></div></p><br>",
    "HRDN-7222": "<p><div class=\"sp\">Compilers turn source code into binary executable code. For a production system a compiler is usually not needed, unless package upgrades are performed by means of their source code. If a compiler is found, execution should be limited to authorized users only (e.g. root user).</div></p><br><p><div class=\"sp\"><p>Compilers are used for translating source code into machine language. This process happens usually during the development cycle, or by package maintainers. Although many systems have a compiler installed, it is often not used. That is an unnecessary risk.</p><p>Evildoers might abuse the presence of a compiler to make their malicious attacks work. Due to protections in the Linux kernel, memory allocation and execution of processes, is limited. To circumvent these protections, a compiler on the related system is needed, so the attacker can determine specific memory locations and leverage a so-called exploit.</p><h4>Hardening options</h4><p>When possible, removal of any unneeded compilers is the best option. This prevents users from compiling source code into binary programs. This is unusual for a production server, as most software comes precompiled. If you still need the compilers on your system, consider changing the file permissions or file ownership. This way only the root, or other privileged users, can use the compiler.</p></div></p><br>",
    "HRDN-7230": "<p><div class=\"sp\">Malware scanners search for any traces of malware. Regular checks are advised to improve the detection rate, in case of an intrusion of the system. Also the proper implementation can prevent malware from spreading to other systems. One example might be installing a virus scanner on a mail gateway, to protect users.</div></p><br><p><div class=\"sp\"><p>Every system has its own role to support the business. Depending on the data stored, or transported, the system needs controls in place to detect malware. A web server would benefit from detecting PHP backdoors, where a mail server would benefit from detecting a wide variety of viruses, worms, and trojans.</p><p>It is suggested to perform regular malware scanning.</p><h3>Generic virus detection</h3><p>Use ClamAV or a commercial alternative</p><h3>Rootkit detection</h3><ul><li>Rootkit Hunter (rkhunter)</li><li>Chkrootkit</li><li>OSSEC</li></ul><h3>Malware detection for web servers</h3><ul><li>Linux Malware Detect (LMD)</li></ul></div></p><br>",
    "HTTP-6640": "<p><div class=\"sp\">Anti Denial of Service (DoS) module and protects against brute force attempts. This control is advised for systems running a webserver and those in particular which are available from public networks.</div></p><br>",
    "HTTP-6641": "<p><div class=\"sp\">Module to protect against SlowLoris attack, especially useful for webservers which are available from public networks.</div></p><br>",
    "HTTP-6642": "<p><div class=\"sp\">Module against spammers, useful for webservers which are available from public networks.</div></p><br>",
    "HTTP-6643": "<p><div class=\"sp\">Module for webservers to act as a web application firewall.</div></p><br>",
    "HTTP-6710": "<p><div class=\"sp\">To protect the privacy of users, including sniffing of sensitive data on networks, enable SSL/TLS in nginx.</div></p><br><p><div class=\"sp\"><p>Enabling TLS in nginx allows it to encrypt the connection between the server and user. Commonly this is referred to as using a SSL certificate. It is good to know that older SSL protocols (SSL v2 and SSL v3) are considered to be weak and should be avoided. The nginx configuration will still use the related \"ssl\" option, but that is independent of the actual protocols which are used. For new deployments consider only to use TLS v1.2.</p><ol><li>Enable SSL on the listen statement of an entry, or with \"ssl on;\"</li><li>Define the certificate</li><li>Define the allowed ciphers</li><li>Define the allowed protocols (SSL / TLS)</li><li>Apply additional measures like SSL stapling</li></ol><p>Lynis Enterprise can help you detect more configuration items and store them centrally.</p></div></p><br>",
    "HTTP-6712": "<p><div class=\"sp\">For auditing purposes logging should be properly configured in nginx. Missing log files or disabled entries might result in losing valuable data for analytics and accounting.</div></p><br><p><div class=\"sp\">Disabled logging:<br>Check in the Lynis log for entries which are disabled, or in the nginx configuration (access_log off).<br><br>Missing logging:<br>Check for missing log files. They are references in the configuration of nginx, but not on disk. The Lynis log will reveal to what specific files this applies.</div></p><br>",
    "HTTP-6714": "<p><div class=\"sp\">This test searches for the presence of error logs.</div></p><br><p><div class=\"sp\">When running a web server, errors will happen. These may include missing files and invalid requests. To learn from these events, the error logging should be enabled. If it is turned off, you may miss out important information.</div></p><br>",
    "HTTP-6716": "<p><div class=\"sp\">This test shows up when one or more lines have 'debug' for the error_log configuration in nginx.</div></p><br><p><div class=\"sp\">Determine which entries have 'debug' appended to the error_log.</div></p><br>",
    "INSE-8000": "<p><div class=\"sp\">This test determines if the inetd package is installed.</div></p><br>",
    "INSE-8002": "<p><div class=\"sp\">This test determines if the inet daemon is active.</div></p><br>",
    "INSE-8006": "<p><div class=\"sp\">When inetd is not used in production, remove it all together, or make sure no entries can be started by accident.</div></p><br>",
    "INSE-8116": "<p><div class=\"sp\">Discover the usage of insecure services via xinetd configuration.</div></p><br><p><div class=\"sp\">Replace any discovered service with a more secure variant.</div></p><br>",
    "INSE-8300": "<p><div class=\"sp\">This test determines if the rsh client tool is installed.</div></p><br><p><div class=\"sp\">When possible replace the rsh client with the more secure SSH protocol and tools.</div></p><br>",
    "INSE-8302": "<p><div class=\"sp\">This test looks in the installed packages for the presence of the rsh server package.</div></p><br><p><div class=\"sp\">Replace the rsh server daemon with SSH when possible. The rsh client and server are considered insecure.</div></p><br>",
    "KRNL-5677": "<p><div class=\"sp\">Kernels with PAE support have additional security controls like No eXecute. When possible, it is advised to use such kernel. For other systems where it is not possible to run such kernel, this control might be hidden/ignored.</div></p><br>",
    "KRNL-5788": "<p><div class=\"sp\">This control is for systems based on Debian/Ubuntu and tests the availability of a new Linux kernel. When an update is available, it's usually a security related update or an update to fix serious flaws.</div></p><br><p><div class=\"sp\">When a kernel update is available for Debian/Ubuntu based systems, they are usually security related. Determine if the related update can be applied and the system scheduled to be rebooted.</div></p><br>",
    "KRNL-5820": "<p><div class=\"sp\">Lynis tests if core dumps are enabled on the system.</div></p><br><p><div class=\"sp\">Core dumps are used in troubleshooting software defects. They contain detailed information from system memory and can be very helpful to determine what happened when the specific software component crashed. At the same time, core dumps can contain very sensitive data. For that reason alone it is advised to only enable core dumps when really needed. Under normal conditions, core dumps can be disabled safely.</div></p><br>",
    "KRNL-5830": "<p><div class=\"sp\">If this test shows up, a reboot of the system is required. Schedule down time for a reboot.</div></p><br><p><div class=\"sp\">Schedule a reboot of the system. See lynis.log for the related packages why a system has to be rebooted.</div></p><br>",
    "KRNL-6000": "<p><div class=\"sp\">By means of sysctl values we can adjust kernel related parameters. Many of them are related to hardening of the network stack, how the kernel deals with processes or files. This control is a generic test with several sysctl variables (configured by the scan profile).</div></p><br><p><div class=\"sp\"><p>The Linux kernel can be tuned with the sysctl command. It uses a list of kernel parameters, which alter how the kernel should behave within the areas of storage, network, memory management, and more.</p><p>Lynis has a default list of best practice values for sysctl. They are tested within this particular control, with a related suggestion when the actual value on the system is different than the expected value. This does not always mean the system is weakly configured. It depends on the primary goal of the system, and its focus area(s). A system with the role to be a router will have to be tuned more aggressively when it comes to the network stack. Production systems with a lot of write activity to the hard disks might need tuning when it comes to buffering.</p><p>We suggest to check each discovered key and determine the best value for your system. There is not a \"one size fits all\" solution here. The additional resources might be useful for further analysis. Also in our Enterprise version we have more details available to help you tuning your systems.</p></div></p><br>",
    "LOGG-2138": "<p><div class=\"sp\">For most Linux systems the kernel log daemon is used. Newer Linux versions may not include this kernel logger, but have an alternative to capture kernel related events. In that case, this control can be ignored. For all other systems it is advised to check why the kernel log daemon is not running.</div></p><br>",
    "LOGG-2154": "<p><div class=\"sp\">To prevent log data from being lost (e.g. destroyed on purpose), logging all data to a remote system is advised.</div></p><br>",
    "LOGG-2190": "<p><div class=\"sp\">Deleted files may sometimes be in use by applications. While this is uncommon behavior, it's usually seen by malicious software to hide its presence on the system. Investigate the related files by determining which application keeps it open and the related reason.</div></p><br><p><div class=\"sp\"><p>Most software needs to read from files, or write to them. It is also common to see that software creates temporary files, to deal with data, until the program closes. Temporary files are often stored in /tmp or /var/tmp.</p><p>To open a file, the software uses a system call (or syscall), like <em>fopen</em>, and tells the kernel if it likes to open it for reading, writing, appending data, or otherwise. It would be too much risk when software could have full access to the hard disk, without any control. So the kernel will return a file descriptor instead, and the software can use that. When it is done with the file, it will tell the kernel again to close. For temporary files it usually then also gives it a request to delete it, so it doesn't use up valuable disk space.</p><p>Some programs are known to deal incorrectly with temporary files and in particular the order of closing a file handle and deleting a file. The result is that the file is deleted from disk, but the file handle is actually not closed. In such case, the data is only freed when the handle gets closed. This may happen at the time the program is stopped or reloaded. With systems running 24 hours a day, this may be a very long time.</p><p>Lynis helps to determine which files are deleted, yet still opened with a file handle. When using the ls command, you could recognize these files by having a reference count of zero (0). This is the second field of the ls output. Also <em>lsof</em> helps you showing what files are opened and which of them are deleted. In such case have a look what process is keeping them open. Sometimes a simple reload or restart may help. It may also be a bug in the software, which in such case could be reported to the vendor or author of the software.</p></div></p><br>",
    "LYNIS": "<p><div class=\"sp\">This is a generic Lynis control (see details)</div></p><br><p><div class=\"sp\">When you got this control, your version might be outdated, or an internal part of Lynis gave a message. First thing to check is if you are running the latest version. If you are running a package from a Linux distribution, consider switching over to the official packages.</div></p><br>",
    "MACF-6208": "<p><div class=\"sp\">This test determines the status of AppArmor, on systems like Debian, Ubuntu, openSUSE, and others.</div></p><br><p><div class=\"sp\"><p>Two common security frameworks are SELinux and AppArmor. The choice for which framework on systems running Debian and Ubuntu is easy. Only AppArmor is available. This is because only support for this framework is compiled into the Linux kernel. When possible enable the capabilities of AppArmor. This helps to restrict processes from accessing data they are not supposed to.</p><p>If you really want to harden your Ubuntu systems, then AppArmor is a great addition. This framework defines what running processes can do, or access. Think of it like a prison guard that continuously monitors its prisoners, to ensure they only do activities that are allowed. The allowed activities are stored in policy files, together with the related processes.</p></div></p><br>",
    "MACF-6234": "<p><div class=\"sp\">This test compares the SELinux system configuration with the actual status.</div></p><br><p><div class=\"sp\">Differences between the actual status and system configuration may result in an unwanted outcome during the next reboot of the system. For that reason it is important to ensure SELinux is properly configured, and reflects the current status.</div></p><br>",
    "MAIL-8818": "<p><div class=\"sp\">To prevent announcing software or version to malicious people or scripts, it is advised to hide such information.</div></p><br><p><div class=\"sp\"><p>It is common to see that software display their version number, name, or other details. While it may look innocent, it is a form of information leakage. It may provide attackers too much information during their reconnaissance phase, in which they try to determine what software is running. Especially when sharing software names together with the version, it becomes much easier to target that software.</p><p>For Postfix it is common to see it that it is running Postfix. Therefore change the \"smtpd_banner\" in main.cf and restart the daemon. The banner could be as simple as showing only \"$myhostname ESMTP\", to indicate this is a mail server, without revealing other details. The hostname is a required part of the standard, and easy to determine anyways.</p></div></p><br>",
    "MAIL-8820": "<p><div class=\"sp\">This set of individual tests perform Postfix testing.</div></p><br><p><div class=\"sp\">Please refer to the hardening guide below.</div></p><br>",
    "MALW-3280": "<p><div class=\"sp\">Depending on your requirements, use an anti-virus tool. While open source options are available, some companies or regulations require the usage of a well-tested anti-virus scanner.</div></p><br><p><div class=\"sp\">Install a commercially available tool if required.</div></p><br>",
    "MALW-3286": "<p><div class=\"sp\">This control checks if the ClamAV database is kept up-to-date with the freshclam utility.</div></p><br><p><div class=\"sp\">Run freshclam to keep your ClamAV installation up-to-date. The database contains signatures and need regular updates.</div></p><br>",
    "MALW-3288": "<p><div class=\"sp\">This control checks if ClamXav is installed on Mac OS X</div></p><br>",
    "NAME-4018": "<p><div class=\"sp\">A misconfigured resolver configuration may result in unexpected system behavior or a decrease in network performance. Worst case it may even make the system unavailable to other systems.</div></p><br><p><div class=\"sp\">While multiple search domains are allowed, it is advised to keep them as low as possible. Instead of repeating the 'search' line, add all domains to the same search statement.</div></p><br>",
    "NAME-4028": "<p><div class=\"sp\">DNS resolving is part of the network functionality of systems. Properly configured network settings are needed for providing business services.<br><br>Unix based systems are usually part of a domain. This domain name is the DNS domain name of the company. Lynis tries to determine what domain name this is, by checking several configuration files. In case this control shows up, Lynis was unable to discover it properly. This might indicate a misconfiguration of the server, or an alternative configuration set-up being used. Check the system and network configuration for the possible cause.</div></p><br><p><div class=\"sp\">Check lynis.log file for any hints why no domain name could be found.</div></p><br>",
    "NAME-4206": "<p><div class=\"sp\">Test the configuration of bind configuration for errors or warnings.</div></p><br><p><div class=\"sp\">When this control shows up, there is most likely a bind configuration issue. This might be caused due to a typo or incorrect setting. The advice is to check your configuration file and restart the bind daemon.</div></p><br>",
    "NAME-4210": "<p><div class=\"sp\">The name or version of software should generally be hidden to external users of the software. In case of Bind, there is no clear benefit of revealing the version. To limit the risk of information leakage to malicious people or scripts, hide the Bind version.</div></p><br><p><div class=\"sp\">Add the version to the options section: <br>options {<br>version \u201cnone\u201d;<br>}<br><br></div></p><br>",
    "NAME-4402": "<p><div class=\"sp\">This test found multiple duplicates in the hosts file</div></p><br><p><div class=\"sp\">When one hostname is more than once defined, it may be caused by automation tooling or manual efforts. This is a sign to check for and find the related cause.</div></p><br>",
    "NAME-4404": "<p><div class=\"sp\">Add the IP name and FQDN to /etc/hosts for proper name resolving</div></p><br>",
    "NAME-4406": "<p><div class=\"sp\">For proper resolving, the entries of localhost and the local defined hostname, could be split. Especially with some middleware and some applications, resolving of the hostname to localhost, might confuse the software.</div></p><br>",
    "NETW-2704": "<p><div class=\"sp\">Nameservers, or DNS servers, are being used to do host resolving. They resolve a hostname like www.google.com into an IP address like 74.135.133.72. If one or more nameservers are not working as expected, it might influence the performance of the system and result in other unexpected issues.</div></p><br><p><div class=\"sp\">Add additional DNS servers to the resolving configuration, which is usually /etc/resolv.conf, or part of the networking scripts. See this file if the configuration or the networking script is the original source to be changed.</div></p><br>",
    "NETW-2705": "<p><div class=\"sp\">Connectivity is the central link for systems to communicate. Most communication occurs on layer 3 (network) for interconnected systems. There DNS resolving is very important for proper functioning.DNS resolving, while it is part of the basics, is often overlooked. To limit the chance of failure or bad performance, at least two working name servers are advised.Lynis tests the availability of name servers and if they actually respond to queries. To determine what DNS servers are used, consult the /etc/resolv.conf file.</div></p><br><p><div class=\"sp\"><p>Nowadays, most systems are connected. At least via the internal network, but often also via the internet. An important requisite in this interconnected web of systems is the ability to use a naming convention, like names for hosts, or names for websites. By using DNS (Domain Name System), we can translate between names and IP addresses.</p><p>Many systems have a weak configuration when it comes to this name translation. It is common to find a missing fallback system, when the primary DNS server is not available. Another issue is that one or more of the name servers listed in /etc/resolv.conf are not even accessible or functioning. With this Lynis control the connectivity is tested.</p><p>Depending on your system, you might need to make changes in your <strong>/etc/resolv.conf</strong> file, or otherwise. Debian based systems might use /etc/network/interfaces to define name servers (dns-nameservers 1.2.3.4 5.6.7.8 9.10.11.12), or /etc/resolvconf/resolv.conf.d/tail.</p></div></p><br>",
    "NETW-3014": "<p><div class=\"sp\">When a network interface is actively listening it is in \"promiscuous mode\". This may happen when running a tool like tcpdump, an IDS, or some other software component.</div></p><br><p><div class=\"sp\">Check the process list for clues which piece of software put the network interface in promiscuous mode.</div></p><br>",
    "NETW-3015": "<p><div class=\"sp\">This test determines which network interfaces are in a listening state (promiscuous).</div></p><br><p><div class=\"sp\">Check any discovered interfaces why they are being in promiscuous mode.</div></p><br>",
    "NETW-3028": "<p><div class=\"sp\">When systems are exchanging data and one of them is waiting, the connection will be displayed as \"WAIT\" in netstat. In such case it's up to the systems to decide how long they want to keep the connection open, for possible new data. Too much waiting connections might have a bad influence on new connections, as the kernel needs to maintain a long list. If this control shows up, it's usually a matter of determining if the behavior is common and if related applications need to be fine-tuned.</div></p><br>",
    "NETW-3032": "<p><div class=\"sp\">Consider the usage of a tool which monitors ARP traffic</div></p><br><p><div class=\"sp\"><p>The network is a dynamic environment where devices show up and disappear again. Proper monitoring of devices can help with the detection of intruders, or find the cause of network issues for some systems.</p><p>This control checks for the presence of a tool like arpwatch. Such tool helps with monitoring the network and store ARP requests. Any device showing up on the network subnet will also show up in the tool. Depending on your environment you might want to consider to deploy this tooling only on one system, instead of each system. In such case it is suggested to disable the control in your Lynis profile.</p></div></p><br>",
    "NETW-3200": "<p><div class=\"sp\">This test checks for several network protocols that are uncommon and are only used in very specific cases. Therefore they are usually safe to disable, to ensure they can't be used or misused.</div></p><br><p><div class=\"sp\">To disable network protocols that are (often) unused, disable them via the modprobe configuration.</div></p><br>",
    "PHP-2320": "<p><div class=\"sp\">PHP enables system administrators to disable possible harmful functions. Depending on the software being used, many functions are not needed for proper functioning. An example of this would be the possibility to download a remote file via PHP, which is only needed in some applications.</div></p><br><p><div class=\"sp\">If you are hosting just one PHP based application, it may be useful to analyze the used functions and restrict all others posing risk. For example to open a remote file or socket.</div></p><br>",
    "PHP-2372": "<p><div class=\"sp\">Software in general should not display software names or versions to normal users of a service, to avoid information leakage.</div></p><br><p><div class=\"sp\">Applications should not leak version information. Disable this via the expose_php option.</div></p><br>",
    "PHP-2374": "<p><div class=\"sp\">This test determines if modules can be loaded with the ld() function</div></p><br><p><div class=\"sp\">By allowing the dl() function, PHP will allow dynamic loading of modules. While good for flexibility, it is a security risk. For that reason newer PHP versions will have it disabled by default. The function has also marked as being deprecated in newer releases.</div></p><br>",
    "PHP-2376": "<p><div class=\"sp\">PHP allows file downloads with the allow_url_fopen setting. If not strictly needed for the applications running on the server, make sure this option is disabled.</div></p><br><p><div class=\"sp\">Most PHP applications don't need remote file downloads. Check your PHP code for any file open requests (fopen), which reference an URL (e.g. http://). If there are none, disable this function.</div></p><br>",
    "PHP-2378": "<p><div class=\"sp\">PHP allows file downloads with the allow_url_include setting. If not strictly needed for the applications running on the server, make sure this option is disabled.</div></p><br>",
    "PHP-2379": "<p><div class=\"sp\">This control checks for the presence of Suhosin.</div></p><br><p><div class=\"sp\">The PHP Suhosin security extension can be used to harden PHP web applications as it enforces the PHP base itself.</div></p><br>",
    "PKGS-7308": "<p><div class=\"sp\">Empty output of RPM command</div></p><br><p><div class=\"sp\">Some systems have rpm installed, yet no packages show up. In this case, this will be flagged as it could be an issue with your package manager or database. Check the system why it contains the rpm binary and if your package manager works as expected.</div></p><br>",
    "PKGS-7312": "<p><div class=\"sp\">This control shows up when there are update for systems running pacman.</div></p><br><p><div class=\"sp\">Since pacman based systems have rolling upgrades, staying up-to-date is important to incorporate security fixes and general software enhancements.</div></p><br>",
    "PKGS-7314": "<p><div class=\"sp\">This control checks the configuration of pacman, a package manager used on Arch Linux.</div></p><br><p><div class=\"sp\">This control determines what has been configured and collects the related configuration</div></p><br>",
    "PKGS-7320": "<p><div class=\"sp\">To determine which packages have a known vulnerability, consider using a tool like arch-audit.</div></p><br><p><div class=\"sp\">Install the arch-audit utility to scan the system.</div></p><br>",
    "PKGS-7322": "<p><div class=\"sp\">The arch-audit tool may have discovered some vulnerable packages.</div></p><br><p><div class=\"sp\">Run arch-audit manually to see what output it provides. If it does show packages that are vulnerable, then update the system using the pacman package manager.</div></p><br>",
    "PKGS-7330": "<p><div class=\"sp\">When this Lynis control is triggered, vulnerable software packages have been found on the system.</div></p><br><p><div class=\"sp\">Apply any patches or upgrades of the available software packages. By looking in the log file or report file, the specific software packages can be detected. Together with the zypper tooling the related updates can be then installed.</div></p><br>",
    "PKGS-7346": "<p><div class=\"sp\">While not directly a security concern, unpurged packages are not installed but still have remains left on the system (e.g. configuration files). In case software is reinstalled, an old configuration might be applied. Proper cleanups are therefore advised.</div></p><br><p><div class=\"sp\"><p>Packages which are removed, but still have some files left on the systems, are called unpurged packages. For example, a changed configuration file might not be deleted by the package manager, to ensure you don't loose your customizations. However if you intended to remove a package fully, an additional step is needed to clean those files. This is \"purging\" and can be done with the <strong>dpkg</strong> command.</p><h3>Command</h3><pre class=\"console\">dpkg --purge</pre></div></p><br>",
    "PKGS-7348": "<p><div class=\"sp\">Lynis tests for unused distfiles on FreeBSD systems</div></p><br><p><div class=\"sp\">The generic advice here is to clean out any unused distfiles.</div></p><br>",
    "PKGS-7370": "<p><div class=\"sp\">Install the debsums utility for additional checks.</div></p><br><p><div class=\"sp\">By using the debsums utility, additional checks can be performed. While we discourage installing unneeded packages, this utility might be an useful addition for auditing your packages.</div></p><br>",
    "PKGS-7380": "<p><div class=\"sp\">Vulnerable packages are a serious risk for the stability and security of a system. When this control shows up, one or more vulnerable software packages have been found. These packages, especially when listening on a network interface, might be abused by attackers.</div></p><br><p><div class=\"sp\">Run pkg_audit to determine what software packages need to be upgraded.</div></p><br>",
    "PKGS-7382": "<p><div class=\"sp\">Portaudit tests packages on FreeBSD based systems and determines what software is vulnerable. Discovered software is a security risk and should be investigated.</div></p><br>",
    "PKGS-7383": "<p><div class=\"sp\">For systems using the yum package manager, a repolist is being checked. If not found, this might indicate that the system is not properly configured to receive updates. Check if yum is properly functioning and receiving package updates. Registration might be needed to fix this problem.</div></p><br>",
    "PKGS-7384": "<p><div class=\"sp\">Install package 'yum-utils' for better consistency checking of the package database</div></p><br>",
    "PKGS-7386": "<p><div class=\"sp\">Install package yum-plugin-security to maintain security updates easier</div></p><br>",
    "PKGS-7387": "<p><div class=\"sp\">This control test if the software repositories via YUM are available. If not, it might be due to bad configuration (e.g. missing registration with RHN).</div></p><br><p><div class=\"sp\">Check the available software repositories output with yum repolist.</div></p><br>",
    "PKGS-7388": "<p><div class=\"sp\">This control tests for the presence of a security repository in the updates. On most Debian based systems this line is there by default, to allow the installation of security patches. When this line is not available, it might indicate that this system does not receive security patches. An alternative is that it uses a merged tree, in that case this control should be ignored for this particular system.</div></p><br>",
    "PKGS-7392": "<p><div class=\"sp\">Lynis tests for vulnerable packages, packages with known security flaws and which already have an update available.</div></p><br><p><div class=\"sp\"><p>Most software will sooner or later encounter a software error. These so-called bugs can make software unstable, or work differently than the programmer had intended. Some of these bugs turn out to be security related, like errors which don't properly check the input, or the amount of data stored in a temporary buffer. This is a weakness, which makes the software vulnerable for abuse.</p><p>Most Linux distributions, like Debian and Ubuntu, mark which package updates are security related. It is then the task for the system administrator to discover these as quickly as possible, and implement them. Depending on company size this can be done as an ad-hoc activity, or using a predefined software patch management process.</p><p>Lynis tests for the presence of any vulnerable packages. When it finds any, this control is triggered, with a related warning. It is marked as high impact, as each vulnerable package has a different potential for being exploited by attackers.  Still you should determine the impact for your environment, and see when you want to apply the related security update.</p><h3>Commands</h3><ul><li>apt-get update</li><li>apt-get upgrade</li></ul><h3>Suggestions</h3><p>Consider using a tool like unattended-upgrade to keep the time of window for vulnerable packages as low as possible. It can be configured to automatically install security updates, while leaving normal updates for later moment of deployment.</p></div></p><br>",
    "PKGS-7393": "<p><div class=\"sp\">This controls checks for vulnerable packages on Gentoo based systems</div></p><br><p><div class=\"sp\">When vulnerabilities are found, you are strongly advised to update the system as soon as possible. Vulnerable packages, especially which allow network communications, have an increased risk.</div></p><br>",
    "PKGS-7394": "<p><div class=\"sp\">This control tests for available upgrades on Ubuntu. Depending on your software upgrade policy, determine if this control is too strict.</div></p><br><p><div class=\"sp\">Software upgrades and patches increase the stability and solve known bugs. In some cases they include security related issues, like software vulnerabilities. Companies need a \"software patch management\" process to properly assess these upgrades and updates, to ensure staying up-to-date and lowering operational risk.</div></p><br>",
    "PKGS-7398": "<p><div class=\"sp\">Most operating systems provide a tool to check for security packages, to fix vulnerable versions of installed software. When possible, install such tool.</div></p><br><p><div class=\"sp\"><p>Software packages are an important part of the system, including its primary goal and duties. On a daily basis, new security flaws are found, many which will affect the ones we have installed. These flaws, also named software vulnerabilities, can cause a lot of troubles for your system. This is especially true when such a software package can be remotely attacked and misused. A successful could result into your system starting to send spam messages, leak confidential data, or become part of a botnet.</p><p>With a package audit tool it is easy to find which packages need to be updated. In most cases packages will be flagged with a security warning when a known vulnerability has been fixed. Newer distributions usually have an audit option as part of the package manager. For other systems, a little bit of research is needed to discover a way to find vulnerable packages. For example the yum-security package is an example used for older systems running RHEL, Fedora, or CentOS.</p></div></p><br>",
    "PKGS-7410": "<p><div class=\"sp\">Most Linux distributions use a kernel package to easily allow upgrading it when bugs or security flaws were found. This test determines the number of installed packages.</div></p><br><p><div class=\"sp\">While it is fine to have a few kernel packages installed, the number should typically not be above 5 installed versions of the kernel package. Remove older versions to keep both the file system and boot loader clean.</div></p><br>",
    "PKGS-7420": "<p><div class=\"sp\">This Lynis test determines if there is a toolkit installed to automatically download and apply upgrades.</div></p><br><p><div class=\"sp\">Consider using a tool for automatically installing software upgrades, such as security patches. Common tools include Auter, dnf-automatic, unattended-upgrade, and yum-cron.</div></p><br>",
    "PRNT-2307": "<p><div class=\"sp\">The configuration file (cupsd.conf) should be have limited file permissions. This reduces who can see the configuration of the CUPS daemon. Generally it should not be readable for normal users.</div></p><br><p><div class=\"sp\">Adjust file permissions of /etc/cups/cupsd.conf</div></p><br>",
    "PRNT-2308": "<p><div class=\"sp\">Depending on the usage of the CUPS daemon, listening on the network should be limited. If the daemon is used a local spooler, it should be configured to listen on localhost only.</div></p><br><p><div class=\"sp\">Adjust the line stating \"Listen\" in the cupsd.conf file. Alter it so it only listens on the localhost interface, if appropriate.<br><br>Listen localhost:631</div></p><br>",
    "PROC-3612": "<p><div class=\"sp\">This control tests for zombie processes</div></p><br><p><div class=\"sp\">Zombie processes are in an \"undead\" status. This means they ended, but were not properly terminated by the kernel. Sometimes it is a matter of waiting, before they disappear. If you got many zombie processes, there might be a specific cause. This is usually related to a software package and how it behaves. An update might solve the issue, especially if more people encountered it as well.</div></p><br>",
    "PROC-3614": "<p><div class=\"sp\">This control checks if there are processes waiting for IO requests to finish. The availability and performance of a system might be in danger when it occurs too often. High IO might be caused due to high disk activity or in some cases network issues (high bandwidth usage, unstable connectivity).</div></p><br><p><div class=\"sp\">Check with the ps binary what processes are having IO requests waiting. Optionally use sysstat or a similar tool set to monitor for recurrences.</div></p><br>",
    "SCHD-7704": "<p><div class=\"sp\">Lynis triggers this control when files have their file permissions set to a dangerous value. For example when everyone can write to them.</div></p><br><p><div class=\"sp\">Check the lynis.log and determine which files need to be changed. Normally it will be sufficient to give these file 0640 permissions.</div></p><br>",
    "SHLL-6202": "<p><div class=\"sp\">Consoles should be protected by only allowing access to single user mode by means of password authentication. Check consoles in /etc/ttys and adjust the related console with parameter 'secure' and mark them as 'insecure'.</div></p><br>",
    "SHLL-6220": "<p><div class=\"sp\">Depending on security requirements, idle sessions should be appropriately checked and dealt with.<br></div></p><br><p><div class=\"sp\">Install a tool like autolog, timeoutd, or adjust /etc/profile and add the TMOUT variable.</div></p><br>",
    "SHLL-6290": "<p><div class=\"sp\">When this control shows up, Bash is vulnerable for one or more Shellshock related issues.</div></p><br><p><div class=\"sp\">Upgrade Bash to the latest version available.</div></p><br>",
    "SNMP-3306": "<p><div class=\"sp\">Older protocol versions of SNMP provide no authentication or protection against data gathering via the network. By using easy guessable names, attackers may use SNMP to gather system details.</div></p><br><p><div class=\"sp\">Change the SNMP community of your systems.</div></p><br>",
    "SQD-3602": "<p><div class=\"sp\">Lynis tests if Squid is running</div></p><br>",
    "SQD-3604": "<p><div class=\"sp\">This test determines where Squid has its configuration stored.</div></p><br>",
    "SQD-3606": "<p><div class=\"sp\">This test determines what version of Squid is available on the system.</div></p><br>",
    "SQD-3610": "<p><div class=\"sp\">-</div></p><br>",
    "SQD-3613": "<p><div class=\"sp\">The configuration permissions of the Squid configuration file should be as strict as possible. By default it may be world readable, or worse.</div></p><br>",
    "SQD-3614": "<p><div class=\"sp\">Lynis retrieves the authentication methods that are configured within Squid. If none are found, the proxy may allow access from untrusted or unknown users.</div></p><br>",
    "SQD-3630": "<p><div class=\"sp\">Limit the upper size of replies within the Squid proxy configuration. This helps to protect resource exhaustion within Squid and thwart malicious attempts.</div></p><br>",
    "SQD-3680": "<p><div class=\"sp\">This Lynis test determines if Squid may reveal its version</div></p><br><p><div class=\"sp\">Disable banners or leaking version numbers to external clients.</div></p><br>",
    "SSH-7408": "<p><div class=\"sp\">Proper hardening of your SSH configuration can reduce known weaknesses</div></p><br><p><div class=\"sp\"><p>The secure shell, or SSH, is one of the most used services. Nearly all machines have a SSH daemon running, to allow system administrators connect and manage the system. SSH is not limited to interactive system administration via the shell. Things like backups, remote configuration, and data transfers are common other uses as well.</p><p>Since SSH has an important function on the system, and firewalls are often opened up to allow traffic, proper hardening of the service is needed. Lynis checks for several key options and helps to avoid weak configurations. With every system having a different role, the right combination of settings needs to be configured.</p><p>Harden your SSH configuration with the specified configuration option listed in the Lynis output. Consult the SSH documentation for the meaning of each option, and select the best possible option for your system. Where possible choose the most strict option, to increase your security defenses.</p><p>The specific configuration settings to harden are listed in the log file (/var/log/lynis.log) and your report file (/var/log/lynis-report.dat).</p><h3>Notes</h3><h4>TCP forwarding</h4><p>A note from the SSH man page: <em>Note that disabling TCP forwarding does not improve security unless users are also denied shell access, as they can always install their own forwarders.</em></p></div></p><br>",
    "SSH-7412": "<p><div class=\"sp\">For proper authorization purposes, do not use direct root logins. Doing so, may result in actions being performed by administrators without any traceability. Also using root permissions directly might increase the risk of intrusion or availability. (e.g. brute force attacks on the password, account lockout)Unless the owner of each key is traceable, public key authentication can be considered.</div></p><br><p><div class=\"sp\">Disable direct root login via the shell script.<br><br>Option 1: Implement sudo<br>Option 2: Implement public key authentication with proper traceability.</div></p><br>",
    "SSH-7416": "<p><div class=\"sp\">SSH has the option to check for file permissions before use configuration and other files. With the StrictModes option, it will only use those files which are properly configured (e.g. not using chmod 777 applied).</div></p><br><p><div class=\"sp\">Set StrictModes to yes in /etc/ssh/sshd_config</div></p><br>",
    "STRG-1840": "<p><div class=\"sp\">Disable drivers like USB storage when not used, to prevent unauthorized storage or data theft</div></p><br><p><div class=\"sp\"><p>Nowadays, most systems have multiple USB ports available. Linux supports USB as well, including a wide variety of hardware devices which can be connected. One of the biggest threats for companies is data theft via USB sticks. They are small while still having a great capacity of data to store.</p><p>When a system does not need any USB devices to be plugged in, simply disable USB support from the BIOS of the system. Otherwise determine what kind of devices should be connected. If this is limited to keyboards and mouses, restrict other types of USB devices, like storage devices. On Linux this can be done by blacklisting drivers.</p></div></p><br>",
    "STRG-1846": "<p><div class=\"sp\">Disable drivers like firewire storage when not used, to prevent unauthorized storage or data theft</div></p><br>",
    "STRG-1930": "<p><div class=\"sp\">When possible, limit the access to NFS exports. If all clients need to access the related NFS exports, then this control might be considered as too strict and should be hidden.</div></p><br>",
    "TIME-3104": "<p><div class=\"sp\">Proper time synchronization is important for authentication services, forensics and troubleshooting. Therefore a time daemon (like ntpd) should be running, or a scheduled task to sync time (like ntpdate).</div></p><br><p><div class=\"sp\">Configure a NTP daemon to keep the time in sync with a time server. Most distributions have a \"ntp\" package available, which can be configured to regularly update the time. If you don't have an internal time server, we suggest to have a look at the ntp.org website, for time servers in your region.</div></p><br>",
    "TIME-3106": "<p><div class=\"sp\">NTP is enabled, however timedatectl is not syncing time</div></p><br><p><div class=\"sp\">When your configuration is set to synchronize time via NTP, this test also checks the output of timedatectl. It found that it is not synchronized currently. This may result in incorrect time on the system.</div></p><br>",
    "TIME-3116": "<p><div class=\"sp\">Time servers are used to sync the time with the host. When a used server is not properly configured or not working, it will be listed as a stratum 16 server, giving it a very low priority. Usually when finding a server with a value of 16, the server should be checked or replaced with an alternative server.</div></p><br><p><div class=\"sp\"><p>Any time server listed as a stratum 16 server is most likely not working correctly. This can be caused by the lack of connectivity, or too strict filtering. Check your NTP configuration to ensure all NTP servers are reachable and restart the NTP daemon.</p></div></p><br>",
    "TIME-3120": "<p><div class=\"sp\">Lynis tests if the used NTP server candidates are reliable enough to be used. If items show up with a dash or minus, they are unreliable and should be checked or replaced.<br><br>The NTP configuration and time synchronization in particular, is important for systems. It helps with properly logging the actual time, which is needed for many services. Having the right time is also important for accounting purposes and forensics.</div></p><br><p><div class=\"sp\">Determine the list of peers with ntpq -p and check for the servers with a dash or minus sign. If these servers keep showing up, check their availability or any firewall rules which might obstruct synchronization from occurring between those systems and the target system.</div></p><br>",
    "TIME-3124": "<p><div class=\"sp\">When only a local source is being used on a system, it might indicate that external sources are not reachable or usable. <br><br>The NTP configuration and time synchronization in particular, is important for systems. It helps with properly logging the actual time, which is needed for many services. Having the right time is also important for accounting purposes and forensics.<br><br>Check the NTP configuration of this system to determine the cause of this finding.</div></p><br><p><div class=\"sp\">Check the peers list (ntpq -p) to determine if there are any NTP servers configured. If they are all listed are faulty (e.g. stratum 16), check your firewall or router configuration.</div></p><br>",
    "TIME-3128": "<p><div class=\"sp\">Lynis checks if the NTP time source candidates can be found in the peers overview. If not, then the configuration usually needs to be checked and updated. Differences between the active configuration and the one stored on disk, may result in a non-functional NTP configuration after reboot.</div></p><br><p><div class=\"sp\">Check both the output of ntpq and the nodes stored in the configuration. Adjust any differences when appropriate.</div></p><br>",
    "TIME-3132": "<p><div class=\"sp\">False-tickers are NTP sources which do not work properly (e.g. non-functional, time not accurate). Lynis checks for false-tickers to prevent systems using bad sources for time synchronization. This may otherwise result in incorrect timestamps in log files and accounting data.</div></p><br><p><div class=\"sp\">Monitor the related falsetickers <br>ntpq -p -n  | grep \"^x\"</div></p><br>",
    "TIME-3136": "<p><div class=\"sp\">The NTP protocol version is gathered by Lynis as an informational test. Only when Lynis is not being able to detect the version, it will provide a suggestion to check it manually.</div></p><br><p><div class=\"sp\">Check ntpq output to determine the NTP version manually.</div></p><br>",
    "TIME-3160": "<p><div class=\"sp\">Lynis checks if step-tickers are configured in /etc/ntp/step-tickers and compares them with the list of servers in the general NTP configuration file.</div></p><br><p><div class=\"sp\">Determine what mismatch is present between the step-tickers file and the servers listed in the NTP configuration file (ntp.conf). If the step-tickers file is empty, then fill it with the servers from the NTP configuration file.</div></p><br>",
    "TOOL-5002": "<p><div class=\"sp\">This control checks if there are tools installed which help with automating system management. This increases integrity and stability of systems, by keep systems equally managed and configured, with only minor exceptions depending on the role of the machine.</div></p><br><p><div class=\"sp\">Install and configure automation tools like configuration management (Cfengine, Puppet or other), to help automating repeating tasks and increase integrity of systems.</div></p><br>",
    "TOOL-5102": "<p><div class=\"sp\">This test checks if fail2ban is used</div></p><br><p><div class=\"sp\">A tool like fail2ban helps with detecting brute-force attemps or other (possible) malicious activities. Then it can use that information and put the related system in a blacklist.</div></p><br>",
    "TOOL-5104": "<p><div class=\"sp\">Lynis triggers this control when none of the jails within fail2ban are enabled.</div></p><br><p><div class=\"sp\">Check the configuration and determine what services need to be enabled within fail2ban.</div></p><br>",
    "USB-1000": "<p><div class=\"sp\">Disable drivers like USB storage when not used. This helps preventing unauthorized storage, data copies, or data theft.</div></p><br>"
}
