{
	"1.1": "<h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Follow the documentation and setup corporate login accounts.</p><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">To ensure that no email addresses outside the organization can be granted IAM permissions to its Google Cloud projects, folders or organization, turn on the Organization Policy for <span class=\"s15\">Domain Restricted Sharing</span><a href=\"https://cloud.google.com/resource-manager/docs/organization-policy/restricting-domains\" class=\"s4\" target=\"_blank\">. Learn more at: </a><a href=\"https://cloud.google.com/resource-manager/docs/organization-policy/restricting-domains\" class=\"a\" target=\"_blank\">https://cloud.google.com/resource-manager/docs/organization-policy/restricting-</a><a href=\"https://cloud.google.com/resource-manager/docs/organization-policy/restricting-domains\" target=\"_blank\">domains</a></p><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">None.</p>",
	"1.2": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">For each Google Cloud Platform project:</p><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Step 1<span class=\"p\">: Identify non-service accounts.</span></h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Step 2<span class=\"p\">: Setup multi-factor authentication for each account.</span></h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">None</p>",
	"1.3": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Step 1<span class=\"p\">: Identify users with the Organization Administrator role.</span></h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Step 2<a href=\"https://cloud.google.com/security-key/\" class=\"s4\" target=\"_blank\">: Setup Security Key Enforcement for each account. Learn more at: </a><a href=\"https://cloud.google.com/security-key/\" target=\"_blank\">https://cloud.google.com/security-key/</a></h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">If an organization administrator loses access to their security key, the user could lose access to their account. For this reason, it is important to set up backup security keys.</p>",
	"1.4": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l26\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the IAM page in the GCP Console using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">https://console.cloud.google.com/iam-admin/iam</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the left navigation pane, click <span class=\"s15\">Service accounts</span>. All service accounts and their corresponding keys are listed.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the service account.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">edit </span>and delete the keys.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From CLI:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">To delete a user managed Service Account Key,</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud iam service-accounts keys delete --iam-account=&lt;user-managed-service-account-EMAIL&gt; &lt;KEY-ID&gt;</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 113%;text-align: left;\">You can disable service account key creation through the <span class=\"s15\">Disable service account key creation </span><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-disableServiceAccountKeyCreation\" class=\"s4\" target=\"_blank\">Organization policy by visiting </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-disableServiceAccountKeyCreation\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/iam-disableServiceAccountKeyCreation</a><a href=\"https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts\" class=\"s4\" target=\"_blank\">. Learn more at: </a><a href=\"https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts\" class=\"a\" target=\"_blank\">https://cloud.google.com/resource-manager/docs/organization-policy/restricting-</a><a href=\"https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts\" target=\"_blank\">service-accounts</a></p><p style=\"padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">In addition, if you do not need to have service accounts in your project, you can also prevent the creation of service accounts through the <span class=\"s15\">Disable service account creation </span><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-disableServiceAccountCreation\" class=\"s4\" target=\"_blank\">Organization policy: </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-disableServiceAccountCreation\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/iam-disableServiceAccountCreation</a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-disableServiceAccountCreation\" class=\"s4\" target=\"_blank\">.</a></p><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Deleting user-managed Service Account Keys may break communication with the applications using the corresponding keys.</p>",
	"1.5": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l31\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">IAM &amp; admin/IAM </span>using <span class=\"s15\">https://console.cloud.google.com/iam-admin/iam</span></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">Members</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify <span class=\"s15\">User-Managed user created </span>service account with roles containing <span class=\"s15\">*Admin</span></p><p style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">or <span class=\"s15\">*admin </span>or role matching <span class=\"s15\">Editor </span>or role matching <span class=\"s15\">Owner</span></p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">Delete bin </span>icon to remove the role from the member (service account in this case)</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l32\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Using a text editor, Remove <span class=\"s15\">Role </span>which contains <span class=\"s15\">roles/*Admin </span>or <span class=\"s15\">roles/*admin </span>or matched <span class=\"s15\">roles/editor </span>or matches 'roles/owner`. Add a role to the bindings array that defines the group members and the role for those members.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">For example, to grant the role roles/appengine.appViewer to the <span class=\"s15\">ServiceAccount </span>which is roles/editor, you would change the example shown below as follows:</p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"bindings\": [</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p class=\"s15\" style=\"padding-left: 23pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"members\": [</p><p style=\"padding-left: 35pt;text-indent: 0pt;line-height: 11pt;text-align: left;\"><a href=\"mailto:our-project-123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">\"serviceAccount:our-</a><a href=\"mailto:123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">project-123@appspot.gserviceaccount.com\",</a></p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"role\": \"roles/appengine.appViewer\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">},</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p style=\"padding-left: 35pt;text-indent: -6pt;text-align: left;\"><a href=\"mailto:email1@gmail.com\" class=\"s17\" target=\"_blank\">\"members\": [ \"user:email1@gmail.com\"</a></p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"role\": \"roles/owner\"</p><p class=\"s15\" style=\"padding-left: 23pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">},</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"members\": [</p><p style=\"padding-left: 41pt;text-indent: 0pt;text-align: left;\"><a href=\"mailto:our-project-123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">\"serviceAccount:our-</a><a href=\"mailto:123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">project-</a><a href=\"mailto:123456789012-compute@developer.gserviceaccount.com\" class=\"s17\" target=\"_blank\">123@appspot.gserviceaccount.com\", </a><a href=\"mailto:compute@developer.gserviceaccount.com\" class=\"s17\" target=\"_blank\">\"serviceAccount:123456789012-compute@developer.gserviceaccount.com\"</a></p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"role\": \"roles/editor\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">}</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"etag\": \"BwUjMhCsNvY=\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">}</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Update the project's IAM policy:</p></li></ol><p style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">gcloud projects set-iam-policy PROJECT_ID iam.json</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 113%;text-align: left;\">Removing <span class=\"s15\">*Admin or</span>*admin<span class=\"s15\">or</span>Editor<span class=\"s15\">or</span>Owner` role assignments from service accounts may break functionality that uses impacted service accounts. Required role(s) should be assigned to impacted service accounts in order to restore broken functionalities.</p>",
	"1.6": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l36\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/iam-admin/iam\" class=\"s4\" target=\"_blank\">Go to the IAM page in the GCP Console by visiting: </a><a href=\"https://console.cloud.google.com/iam-admin/iam\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/iam</a><a href=\"https://console.cloud.google.com/iam-admin/iam\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the filter table text bar. Type <span class=\"s15\">Role: Service Account User</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">Delete Bin </span>icon in front of the role <span class=\"s15\">Service Account User </span>for every user listed as a result of a filter.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the filter table text bar. Type <span class=\"s15\">Role: Service Account Token Creator</span></p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">Delete Bin </span>icon in front of the role <span class=\"s15\">Service Account Token Creator </span>for every user listed as a result of a filter.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l37\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Using a text editor, remove the bindings with the <span class=\"s15\">roles/iam.serviceAccountUser</span></p><p style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">or <span class=\"s15\">roles/iam.serviceAccountTokenCreator</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">For example, you can use the iam.json file shown below as follows:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"bindings\": [</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p class=\"s15\" style=\"padding-left: 23pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"members\": [</p><p style=\"padding-left: 35pt;text-indent: 0pt;line-height: 11pt;text-align: left;\"><a href=\"mailto:our-project-123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">\"serviceAccount:our-</a><a href=\"mailto:123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">project-123@appspot.gserviceaccount.com\",</a></p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"role\": \"roles/appengine.appViewer\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">},</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p style=\"padding-left: 35pt;text-indent: -6pt;text-align: left;\"><a href=\"mailto:email1@gmail.com\" class=\"s17\" target=\"_blank\">\"members\": [ \"user:email1@gmail.com\"</a></p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"role\": \"roles/owner\"</p><p class=\"s15\" style=\"padding-left: 23pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">},</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">{</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"members\": [</p><p style=\"padding-left: 41pt;text-indent: 0pt;text-align: left;\"><a href=\"mailto:our-project-123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">\"serviceAccount:our-</a><a href=\"mailto:123@appspot.gserviceaccount.com\" class=\"s17\" target=\"_blank\">project-</a><a href=\"mailto:123456789012-compute@developer.gserviceaccount.com\" class=\"s17\" target=\"_blank\">123@appspot.gserviceaccount.com\", </a><a href=\"mailto:compute@developer.gserviceaccount.com\" class=\"s17\" target=\"_blank\">\"serviceAccount:123456789012-compute@developer.gserviceaccount.com\"</a></p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">\"role\": \"roles/editor\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">}</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">],</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">\"etag\": \"BwUjMhCsNvY=\"</p><p class=\"s15\" style=\"padding-left: 29pt;text-indent: 0pt;text-align: left;\">}</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Update the project's IAM policy:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud projects set-iam-policy PROJECT_ID iam.json</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 113%;text-align: left;\">After revoking <span class=\"s15\">Service Account User </span>or <span class=\"s15\">Service Account Token Creator </span>roles at the project level from all impacted user account(s), these roles should be assigned to a user(s) for specific service account(s) according to business needs.</p>",
	"1.7": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Delete any external (user-managed) Service Account Key older than 90 days:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l43\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to <span class=\"s15\">APIs &amp; Services\\Credentials </span>using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">https://console.cloud.google.com/apis/credentials</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the Section <span class=\"s15\">Service Account Keys</span>, for every external (user-managed) service account key where <span class=\"s15\">creation date </span>is greater than or equal to the past 90 days, click <span class=\"s15\">Delete Bin Icon </span>to <span class=\"s15\">Delete Service Account key</span></p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create a new external (user-managed) Service Account Key for a Service Account:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l44\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to <span class=\"s15\">APIs &amp; Services\\Credentials </span>using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">https://console.cloud.google.com/apis/credentials</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Create Credentials </span>and Select <span class=\"s15\">Service Account Key</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Choose the service account in the drop-down list for which an External (user-managed) Service Account key needs to be created.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select the desired key type format among <span class=\"s15\">JSON </span>or <span class=\"s15\">P12</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create</span>. It will download the <span class=\"s15\">private key</span>. Keep it safe.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Close </span>if prompted.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">The site will redirect to the <span class=\"s15\">APIs &amp; Services\\Credentials </span>page. Make a note of the new <span class=\"s15\">ID </span>displayed in the <span class=\"s15\">Service account keys </span>section.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 115%;text-align: left;\">Rotating service account keys will break communication for dependent applications. Dependent applications need to be configured manually with the new key <span class=\"s15\">ID </span>displayed in the <span class=\"s15\">Service account keys</span>section and the <span class=\"s15\">private key </span>downloaded by the user.</p>",
	"1.8": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l49\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">IAM &amp; Admin/IAM </span>using <span class=\"s15\">https://console.cloud.google.com/iam-admin/iam</span>.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">For any member having both <span class=\"s15\">Service Account Admin </span>and <span class=\"s15\">Service account User </span>roles granted/assigned, click the <span class=\"s15\">Delete Bin </span>icon to remove either role from the member.</p></li></ol><p style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">Removal of a role should be done based on the business requirements.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">The removed role should be assigned to a different user based on business needs.</p>",
	"1.9": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l53\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud KMS <span class=\"s15\">Cryptokeys</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud kms keys list --keyring=[key_ring_name] --location=global --format=json | jq '.[].name'</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 19pt;text-indent: -18pt;text-align: center;\">Remove IAM policy binding for a KMS key to remove access to <span class=\"s15\">allUsers </span>and</p></li></ol><p class=\"s15\" style=\"padding-left: 95pt;text-indent: 0pt;text-align: center;\">allAuthenticatedUsers <span class=\"p\">using the below command.</span></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud kms keys remove-iam-policy-binding [key_name] --keyring=[key_ring_name] --location=global --member='allAuthenticatedUsers' --role='[role]'</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud kms keys remove-iam-policy-binding [key_name] --keyring=[key_ring_name] --location=global --member='allUsers' --role='[role]'</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 113%;text-align: left;\">Removing the binding for <span class=\"s15\">allUsers </span>and <span class=\"s15\">allAuthenticatedUsers </span>members denies accessing <span class=\"s15\">cryptokeys </span>to anonymous or public users.</p>",
	"1.10": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l60\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Cryptographic Keys </span><a href=\"https://console.cloud.google.com/security/kms\" class=\"s4\" target=\"_blank\">by visiting: </a><a href=\"https://console.cloud.google.com/security/kms\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/security/kms</a><a href=\"https://console.cloud.google.com/security/kms\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the specific key ring</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">From the list of keys, choose the specific key and Click on <span class=\"s15\">Right side pop up the blade (3 dots)</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on <span class=\"s15\">Edit rotation period</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">On the pop-up window, <span class=\"s15\">Select a new rotation period </span>in days which should be less than 90 and then choose <span class=\"s15\">Starting on </span>date (date from which the rotation period begins).</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l61\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Update and schedule rotation by <span class=\"s15\">ROTATION_PERIOD </span>and <span class=\"s15\">NEXT_ROTATION_TIME </span>for each key:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud kms keys update new --keyring=KEY_RING --location=LOCATION --next-rotation-time=NEXT_ROTATION_TIME --rotation-period=ROTATION_PERIOD</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">After a successful key rotation, the older key version is required in order to decrypt the data encrypted by that previous key version.</p>",
	"1.11": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l67\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">IAM &amp; Admin/IAM </span>using <span class=\"s15\">https://console.cloud.google.com/iam-admin/iam</span></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">For any member having <span class=\"s15\">Cloud KMS Admin </span>and any of the <span class=\"s15\">Cloud KMS CryptoKey Encrypter/Decrypter</span>, <span class=\"s15\">Cloud KMS CryptoKey Encrypter</span>, <span class=\"s15\">Cloud KMS CryptoKey Decrypter </span>roles granted/assigned, click the <span class=\"s15\">Delete Bin </span>icon to remove the role from the member.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Note: Removing a role should be done based on the business requirement.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Removed roles should be assigned to another user based on business needs.</p>",
	"1.12": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l72\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to <span class=\"s15\">APIs &amp; Services\\Credentials </span>using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">https://console.cloud.google.com/apis/credentials</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the section <span class=\"s15\">API Keys</span>, to delete API Keys: Click the <span class=\"s15\">Delete Bin Icon </span>in front of every <span class=\"s15\">API Key Name</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Deleting an API key will break dependent applications (if any).</p>",
	"1.13": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l77\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to <span class=\"s15\">APIs &amp; Services\\Credentials </span>using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">https://console.cloud.google.com/apis/credentials</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the section <span class=\"s15\">API Keys</span>, Click the <span class=\"s15\">API Key Name</span>. The API Key properties display on a new page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Key restrictions </span>section, set the application restrictions to any of <span class=\"s15\">HTTP referrers, IP Adresses, Android Apps, iOs Apps</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Repeat steps 2,3,4 for every unrestricted API key.</p></li></ol><p style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\"><b>Note: </b>Do not set <span class=\"s15\">HTTP referrers </span>to wild-cards (* or *.[TLD] or <i>.[TLD]/</i>) allowing access to any/wide HTTP referrer(s)</p><p style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Do not set <span class=\"s15\">IP addresses </span>and referrer to <span class=\"s15\">any host (0.0.0.0 or 0.0.0.0/0 or</span></p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">::0)</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">Setting <span class=\"s15\">Application Restrictions </span>may break existing application functioning, if not done carefully.</p>",
	"1.14": "<h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l82\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to <span class=\"s15\">APIs &amp; Services\\Credentials </span>using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">https://console.cloud.google.com/apis/credentials</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the section <span class=\"s15\">API Keys</span>, Click the <span class=\"s15\">API Key Name</span>. The API Key properties display on a new page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Key restrictions </span>section go to <span class=\"s15\">API restrictions</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">Select API </span>drop-down to choose an API.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Repeat steps 2,3,4,5 for every unrestricted API key</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\"><b>Note: </b>Do not set <span class=\"s15\">API restrictions </span>to <span class=\"s15\">Google Cloud APIs</span>, as this option allows access to all services offered by Google cloud.</p><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Setting <span class=\"s15\">API restrictions </span>may break existing application functioning, if not done carefully.</p>",
	"1.15": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l87\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">APIs &amp; Services\\Credentials </span>using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">https://console.cloud.google.com/apis/credentials</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the section <span class=\"s15\">API Keys</span>, Click the <span class=\"s15\">API Key Name</span>. The API Key properties display on a new page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">REGENERATE KEY </span>to rotate API key.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Repeat steps 2,3,4 for every API key that has not been rotated in the last 90 days.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\"><b>Note: </b>Do not set <span class=\"s15\">HTTP referrers </span>to wild-cards (* or *.[TLD] or <i>.[TLD]/</i>) allowing access to any/wide HTTP referrer(s)</p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Do not set <span class=\"s15\">IP addresses </span>and referrer to <span class=\"s15\">any host (0.0.0.0 or 0.0.0.0/0 or ::0)</span></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p class=\"s15\" style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">Regenerating Key <span class=\"p\">may break existing client connectivity as the client will try to connect with older API keys they have stored on devices.</span></p>",
	"2.1": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l97\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to <span class=\"s15\">Audit Logs </span><a href=\"https://console.cloud.google.com/iam-admin/audit\" class=\"s4\" target=\"_blank\">by visiting </a><a href=\"https://console.cloud.google.com/iam-admin/audit\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/audit</a><a href=\"https://console.cloud.google.com/iam-admin/audit\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p class=\"s19\" style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/logging/docs/audit/configure-data-access\" class=\"s4\" target=\"_blank\">Follow the steps at </a><a href=\"https://cloud.google.com/logging/docs/audit/configure-data-access\" class=\"a\" target=\"_blank\">https://cloud.google.com/logging/docs/audit/configure-data-</a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">access</span> <span style=\" color: #000;\">to enable audit logs for all Google Cloud services. Ensure that no exemptions are allowed.</span></p></li></ol><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l98\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To read the project's IAM policy and store it in a file run a command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud projects get-iam-policy PROJECT_ID &gt; /tmp/project_policy.yaml</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Alternatively, the policy can be set at the organization or folder level. If setting the policy at the organization level, it is not necessary to also set it for each folder or project.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud organizations get-iam-policy ORGANIZATION_ID &gt; /tmp/org_policy.yaml gcloud resource-manager folders get-iam-policy FOLDER_ID &gt;</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">/tmp/folder_policy.yaml</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Edit policy in /tmp/policy.yaml, adding or changing only the audit logs configuration to:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">auditConfigs:</p><ul id=\"l99\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;line-height: 11pt;text-align: left;\">auditLogConfigs:</p><ul id=\"l100\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 29pt;text-indent: -12pt;line-height: 11pt;text-align: left;\">logType: DATA_WRITE</p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: 0pt;text-align: left;\">logType: DATA_READ service: allServices</p></li></ul></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Note: <span class=\"s15\">exemptedMembers: </span><span class=\"p\">is not set as audit logging should be enabled for all the users</span></h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To write new IAM policy run command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud organizations set-iam-policy ORGANIZATION_ID /tmp/org_policy.yaml gcloud resource-manager folders set-iam-policy FOLDER_ID</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">/tmp/folder_policy.yaml</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud projects set-iam-policy PROJECT_ID /tmp/project_policy.yaml</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">If the preceding command reports a conflict with another change, then repeat these steps, starting with the first step.</p><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">There is no charge for Admin Activity audit logs. Enabling the Data Access audit logs might result in your project being charged for the additional logs usage.</p>",
	"2.2": "<h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l106\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/viewer\" class=\"s4\" target=\"_blank\">by visiting </a><a href=\"https://console.cloud.google.com/logs/viewer\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/viewer</a><a href=\"https://console.cloud.google.com/logs/viewer\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">This step converts <span class=\"s15\">Filter Bar </span>to <span class=\"s15\">Advanced Filter Bar</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Clear any text from the <span class=\"s15\">Advanced Filter </span>field. This ensures that the <span class=\"s15\">log-filter </span>is set to empty and captures all the logs.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter </span>and the result should display all logs.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Sink</span>, which opens a menu on the right.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the fields and click <span class=\"s15\">Create Sink</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\"><a href=\"https://cloud.google.com/logging/docs/export/configure_export_v2#dest-create\" class=\"s4\" target=\"_blank\">For more information, see </a><a href=\"https://cloud.google.com/logging/docs/export/configure_export_v2#dest-create\" class=\"a\" target=\"_blank\">https://cloud.google.com/logging/docs/export/configure_export_v2#dest-create</a>. <b>From Command Line:</b></p><p style=\"padding-left: 61pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">To create a sink to export all log entries in a Google Cloud Storage bucket:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud logging sinks create &lt;sink-name&gt; storage.googleapis.com/DESTINATION_BUCKET_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Sinks can be created for a folder or organization, which will include all projects.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud logging sinks create &lt;sink-name&gt; storage.googleapis.com/DESTINATION_BUCKET_NAME --include-children --folder=FOLDER_ID | --organization=ORGANIZATION_ID</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Note:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l107\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">A sink created by the command-line above will export logs in storage buckets. However, sinks can be configured to export logs into BigQuery, or Cloud Pub/Sub, or <span class=\"s15\">Custom Destination</span>.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">While creating a sink, the sink option <span class=\"s15\">--log-filter </span>is not used to ensure the sink exports all log entries.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">A sink can be created at a folder or organization level that collects the logs of all the projects underneath bypassing the option <span class=\"s15\">--include-children </span>in the gcloud command.</p></li></ol><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">There are no costs or limitations in Stackdriver Logging for exporting logs, but the export destinations charge for storing or transmitting the log data.</p>",
	"2.3": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l112\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">If sinks are <b>not </b>configured, first follow the instructions in the recommendation:</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Ensure that sinks are configured for all Log entries<span class=\"p\">.</span></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">For each storage bucket configured as a sink, go to the Cloud Storage browser at</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">https://console.cloud.google.com/storage/browser/&lt;BUCKET_NAME&gt;<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the Bucket Lock tab near the top of the page.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the Retention policy entry, click the Add Duration link. The <span class=\"s15\">Set a retention policy </span>dialog box appears.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Enter the desired length of time for the retention period and click <span class=\"s15\">Save policy</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Set the <span class=\"s15\">Lock status </span>for this retention policy to <span class=\"s15\">Locked</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l113\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To list all sinks destined to storage buckets:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud logging sinks list --folder=FOLDER_ID | --organization=ORGANIZATION_ID</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">| --project=PROJECT_ID</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">For each storage bucket listed above, set a retention policy and lock it:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gsutil retention set [TIME_DURATION] gs://[BUCKET_NAME] gsutil retention lock gs://[BUCKET_NAME]</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\"><a href=\"https://cloud.google.com/storage/docs/using-bucket-lock#set-policy\" class=\"s4\" target=\"_blank\">For more information, visit </a><a href=\"https://cloud.google.com/storage/docs/using-bucket-lock#set-policy\" class=\"a\" target=\"_blank\">https://cloud.google.com/storage/docs/using-bucket-lock#set-policy</a><a href=\"https://cloud.google.com/storage/docs/using-bucket-lock#set-policy\" class=\"s4\" target=\"_blank\">.</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Locking a bucket is an irreversible action. Once you lock a bucket, you cannot remove the retention policy from the bucket or decrease the retention period for the policy.</p>",
	"2.4": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed log metric:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l121\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on the <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">(protoPayload.serviceName=\"cloudresourcemanager.googleapis.com\") AND (ProjectOwnership OR projectOwnerInvitee)</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">OR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"REMOVE\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">AND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\") OR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"ADD\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">AND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\")</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter</span>. The logs display based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: justify;\">In the <span class=\"s15\">Metric Editor </span>menu on the right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and the <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This ensures that the log metric counts the number of log entries matching the advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the display prescribed Alert Policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l122\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the newly created metric under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the desired metric and select <span class=\"s15\">Create alert from Metric</span>. A new page opens.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l123\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;line-height: 11pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notifications channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create a prescribed Log Metric:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l124\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Reference for Command Usage: https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create prescribed Alert Policy</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Reference for Command Usage: https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</p></li></ul></li></ol><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"2.5": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed log metric:</h4><ol id=\"l131\"><li data-list-text=\"1.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on the <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">protoPayload.methodName=\"SetIamPolicy\" AND protoPayload.serviceData.policyDelta.auditConfigDeltas:*</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: justify;\">Click <span class=\"s15\">Submit Filter</span>. Display logs appear based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: justify;\">In the <span class=\"s15\">Metric Editor </span>menu on the right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This will ensure that the log metric counts the number of log entries matching the user's advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create a prescribed Alert Policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l132\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the new metric the user just created, under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the new metric and select <span class=\"s15\">Create alert from Metric</span>. A new page opens.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l133\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;line-height: 11pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notifications channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create a prescribed Log Metric:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l134\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Create prescribed Alert Policy</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</a></p></li></ul></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"2.6": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed log metric:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l140\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on the <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">resource.type=\"iam_role\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">AND protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR protoPayload.methodName=\"google.iam.admin.v1.DeleteRole\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">OR protoPayload.methodName=\"google.iam.admin.v1.UpdateRole\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter</span>. Display logs appear based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Metric Editor </span>menu on the right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This ensures that the log metric counts the number of log entries matching the advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create a prescribed Alert Policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l141\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the new metric that was just created under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the metric and select <span class=\"s15\">Create alert from Metric</span>. A new page displays.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value ensures that a notification is triggered for every owner change in the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l142\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notification channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Log Metric:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l143\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Alert Policy:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</a></p></li></ul></li></ol><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"2.7": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed log metric:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l149\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on the <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">resource.type=\"gce_firewall_rule\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">AND jsonPayload.event_subtype=\"compute.firewalls.patch\" OR jsonPayload.event_subtype=\"compute.firewalls.insert\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter</span>. Display logs appear based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Metric Editor </span>menu on the right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This ensures that the log metric counts the number of log entries matching the advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Alert Policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l150\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the newly created metric under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the new metric and select <span class=\"s15\">Create alert from Metric</span>. A new page displays.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value ensures that a notification is triggered for every owner change in the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l151\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;line-height: 11pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notifications channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Log Metric</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l152\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed alert policy:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</a></p></li></ul></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"2.8": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Log Metric:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l158\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click the down arrow symbol on the <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">Convert to Advanced Filter</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">resource.type=\"gce_route\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">AND jsonPayload.event_subtype=\"compute.routes.delete\" OR jsonPayload.event_subtype=\"compute.routes.insert\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter</span>. Display logs appear based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Metric Editor </span>menu on the right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This ensures that the log metric counts the number of log entries matching the user's advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed alert policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l159\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the newly created metric under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the new metric and select <span class=\"s15\">Create alert from Metric</span>. A new page displays.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value ensures that a notification is triggered for every owner change in the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l160\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notification channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Log Metric:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l161\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed the alert policy:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</a></p></li></ul></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"2.9": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed log metric:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l167\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">resource.type=gce_network</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">AND jsonPayload.event_subtype=\"compute.networks.insert\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">OR jsonPayload.event_subtype=\"compute.networks.patch\" OR jsonPayload.event_subtype=\"compute.networks.delete\"</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">OR jsonPayload.event_subtype=\"compute.networks.removePeering\" OR jsonPayload.event_subtype=\"compute.networks.addPeering\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter</span>. Display logs appear based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Metric Editor </span>menu on the right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This ensures that the log metric counts the number of log entries matching the user's advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed alert policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l168\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the newly created metric under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the new metric and select <span class=\"s15\">Create alert from Metric</span>. A new page appears.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of 0 for the most recent value will ensure that a notification is triggered for every owner change in the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 199%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l169\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notification channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Log Metric:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l170\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</a></p><p style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed alert policy:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</a></p></li></ul></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"2.10": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed log metric:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l176\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on the <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">resource.type=gcs_bucket</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">AND protoPayload.methodName=\"storage.setIamPermissions\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter</span>. Display logs appear based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Metric Editor </span>menu on right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This ensures that the log metric counts the number of log entries matching the user's advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Alert Policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l177\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the newly created metric under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the new metric and select <span class=\"s15\">Create alert from Metric</span>. A new page appears.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l178\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;line-height: 11pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notifications channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Log Metric:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l179\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed alert policy:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</a></p></li></ul></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"2.11": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><h4 style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed Log Metric:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l186\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Logging/Logs </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">by visiting </a><span style=\" color: #00F; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;\">https://console.cloud.google.com/logs/metrics</span> and click \"CREATE METRIC\".</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the down arrow symbol on the <span class=\"s15\">Filter Bar </span>at the rightmost corner and select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">Convert to Advanced Filter<span class=\"p\">.</span></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Clear any text and add:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">protoPayload.methodName=\"cloudsql.instances.update\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Submit Filter</span>. Display logs appear based on the filter text entered by the user.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Metric Editor </span>menu on right, fill out the name field. Set <span class=\"s15\">Units </span>to <span class=\"s15\">1 </span>(default) and <span class=\"s15\">Type </span>to <span class=\"s15\">Counter</span>. This ensures that the log metric counts the number of log entries matching the user's advanced logs query.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create Metric</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed alert policy:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l187\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the newly created metric under the section <span class=\"s15\">User-defined Metrics </span><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/logs/metrics</a><a href=\"https://console.cloud.google.com/logs/metrics\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the 3-dot icon in the rightmost column for the new metric and select <span class=\"s15\">Create alert from Metric</span>. A new page appears.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Fill out the alert policy configuration and click <span class=\"s15\">Save</span>. Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the user's project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;\">Set `Aggregator` to `Count` Set `Configuration`:</p><ul id=\"l188\"><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Condition: above</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">Threshold: 0</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"-\"><p class=\"s15\" style=\"padding-left: 17pt;text-indent: -12pt;text-align: left;\">For: most recent value</p></li></ul><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the desired notification channels in the section <span class=\"s15\">Notifications</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Name the policy and click <span class=\"s15\">Save</span>.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed log metric:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ul id=\"l189\"><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Use the command: gcloud beta logging metrics create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Create the prescribed alert policy:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Use the command: gcloud alpha monitoring policies create</p></li><li data-list-text=\"\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" class=\"s4\" target=\"_blank\">Reference for command usage: </a><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\" target=\"_blank\">https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create</a></p></li></ul></li></ol><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Based on the user's service tiers, the Stackdriver account may be charged.</p>",
	"3.1": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l196\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">VPC networks </span><a href=\"https://console.cloud.google.com/networking/networks/list\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://console.cloud.google.com/networking/networks/list\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/networking/networks/list</a><a href=\"https://console.cloud.google.com/networking/networks/list\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the network named <span class=\"s15\">default</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">On the network detail page, click <span class=\"s15\">EDIT</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">DELETE VPC NETWORK</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">If needed, create a new network to replace the default network.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">For each Google Cloud Platform project,</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l197\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Delete the default network:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute networks delete default</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">If needed, create a new network to replace it:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute networks create NETWORK_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">The user can prevent the default network and its insecure default firewall rules from being created by setting up an Organization Policy to <span class=\"s15\">Skip default network creation </span><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/compute-skipDefaultNetworkCreation\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/compute-skipDefaultNetworkCreation\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/compute-skipDefaultNetworkCreation</a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/compute-skipDefaultNetworkCreation\" class=\"s4\" target=\"_blank\">.</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">When an organization deletes the default network, it may need to migrate or service onto a new network.</p>",
	"3.2": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">For each Google Cloud Platform project,</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l201\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Follow the documentation and create a non-legacy network suitable for the organization's requirements.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Follow the documentation and delete the networks in the <span class=\"s15\">legacy </span>mode.</p></li></ol><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">None.</p>",
	"3.3": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l206\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Cloud DNS </span><a href=\"https://console.cloud.google.com/net-services/dns/zones\" class=\"s4\" target=\"_blank\">by visiting </a><a href=\"https://console.cloud.google.com/net-services/dns/zones\" class=\"a\" target=\"_blank\">https://console.cloud..google.com/net-services/dns/zones</a><a href=\"https://console.cloud.google.com/net-services/dns/zones\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">For each zone of <span class=\"s15\">Type Public</span>, set <span class=\"s15\">DNSSEC </span>to <span class=\"s15\">On</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Use the below command to enable <span class=\"s15\">DNSSEC </span>for Cloud DNS Zone Name.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud dns managed-zones update ZONE_NAME --dnssec-state on</p>",
	"3.4": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l209\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">If it is necessary to change the settings for a managed zone where it has been enabled, NSSEC must be turned off and re-enabled with different settings. To turn off DNSSEC, run the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud dns managed-zones update ZONE_NAME --dnssec-state off</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">To update key-signing for a reported managed DNS Zone, run the following command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><table style=\"border-collapse:collapse;margin-left:55.394pt\" cellspacing=\"0\"><tbody><tr style=\"height:24pt\"><td style=\"width:479pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-left-style:solid;border-left-width:1pt;border-left-color:#000009;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" colspan=\"2\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">gcloud dns managed-zones update ZONE_NAME --dnssec-state on --ksk-algorithm KSK_ALGORITHM --ksk-key-length KSK_KEY_LENGTH --zsk-algorithm ZSK_ALGORITHM -</p></td></tr><tr style=\"height:13pt\"><td style=\"width:321pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">-zsk-key-length ZSK_KEY_LENGTH --denial-of-existence</p></td><td style=\"width:158pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 2pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">DENIAL_OF_EXISTENCE</p></td></tr><tr style=\"height:41pt\"><td style=\"width:321pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009\"><p class=\"s9\" style=\"padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">Supported algorithm options and key lengths are as follows.</p></td><td style=\"width:158pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td></tr><tr style=\"height:19pt\"><td style=\"width:321pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">Algorithm           KSK Length</p></td><td style=\"width:158pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-top: 1pt;padding-left: 32pt;text-indent: 0pt;text-align: left;\">ZSK Length</p></td></tr><tr style=\"height:18pt\"><td style=\"width:321pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s21\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 1pt;text-align: left;\"></p><p class=\"s20\" style=\"padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">RSASHA1            1024,2048</p></td><td style=\"width:158pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p style=\"padding-left: 32pt;text-indent: 0pt;line-height: 1pt;text-align: left;\"></p><p class=\"s20\" style=\"padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td></tr><tr style=\"height:12pt\"><td style=\"width:321pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">RSASHA256           1024,2048</p></td><td style=\"width:158pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 32pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td></tr><tr style=\"height:12pt\"><td style=\"width:321pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">RSASHA512           1024,2048</p></td><td style=\"width:158pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 32pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td></tr><tr style=\"height:12pt\"><td style=\"width:321pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">ECDSAP256SHA256        256</p></td><td style=\"width:158pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 32pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">256</p></td></tr><tr style=\"height:13pt\"><td style=\"width:321pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">ECDSAP384SHA384        384</p></td><td style=\"width:158pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 32pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">384</p></td></tr><tr style=\"height:27pt\"><td style=\"width:321pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009\"><p class=\"s12\" style=\"padding-top: 11pt;padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;\">References:</p></td><td style=\"width:158pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td></tr></tbody></table><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"3.5": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l212\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">If the need exists to change the settings for a managed zone where it has been enabled, DNSSEC must be turned off and then re-enabled with different settings. To turn off DNSSEC, run following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud dns managed-zones update ZONE_NAME --dnssec-state off</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">To update zone-signing for a reported managed DNS Zone, run the following command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud dns managed-zones update ZONE_NAME --dnssec-state on --ksk-algorithm KSK_ALGORITHM --ksk-key-length KSK_KEY_LENGTH --zsk-algorithm ZSK_ALGORITHM -</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">-zsk-key-length ZSK_KEY_LENGTH --denial-of-existence DENIAL_OF_EXISTENCE</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Supported algorithm options and key lengths are as follows.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><table style=\"border-collapse:collapse;margin-left:55.394pt\" cellspacing=\"0\"><tbody><tr style=\"height:18pt\"><td style=\"width:162pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">Algorithm</p></td><td style=\"width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-bottom-style:dashed;border-bottom-width:1pt\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-top: 1pt;text-indent: 0pt;text-align: left;\">KSK Length</p></td><td style=\"width:72pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009\" bgcolor=\"#DDD9C3\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td><td style=\"width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#000009;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-top: 1pt;text-indent: 0pt;text-align: left;\">ZSK Length</p></td></tr><tr style=\"height:17pt\"><td style=\"width:162pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p style=\"padding-left: 5pt;text-indent: 0pt;line-height: 1pt;text-align: left;\"></p><p class=\"s20\" style=\"padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">RSASHA1</p></td><td style=\"width:60pt;border-top-style:dashed;border-top-width:1pt\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-top: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td><td style=\"width:72pt\" bgcolor=\"#DDD9C3\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td><td style=\"width:185pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p style=\"text-indent: 0pt;line-height: 1pt;text-align: left;\"></p><p class=\"s20\" style=\"padding-top: 4pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td></tr><tr style=\"height:12pt\"><td style=\"width:162pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">RSASHA256</p></td><td style=\"width:60pt\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td><td style=\"width:72pt\" bgcolor=\"#DDD9C3\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td><td style=\"width:185pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td></tr><tr style=\"height:12pt\"><td style=\"width:162pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">RSASHA512</p></td><td style=\"width:60pt\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td><td style=\"width:72pt\" bgcolor=\"#DDD9C3\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td><td style=\"width:185pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 10pt;text-align: left;\">1024,2048</p></td></tr><tr style=\"height:12pt\"><td style=\"width:162pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;\">ECDSAP256SHA256</p></td><td style=\"width:60pt\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 10pt;text-align: left;\">256</p></td><td style=\"width:72pt\" bgcolor=\"#DDD9C3\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td><td style=\"width:185pt;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 10pt;text-align: left;\">384</p></td></tr><tr style=\"height:13pt\"><td style=\"width:162pt;border-left-style:solid;border-left-width:1pt;border-left-color:#000009;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">ECDSAP384SHA384</p></td><td style=\"width:60pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 11pt;text-align: left;\">384</p></td><td style=\"width:72pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009\" bgcolor=\"#DDD9C3\"><p style=\"text-indent: 0pt;text-align: left;\"><br></p></td><td style=\"width:185pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#000009;border-right-style:solid;border-right-width:1pt;border-right-color:#000009\" bgcolor=\"#DDD9C3\"><p class=\"s20\" style=\"text-indent: 0pt;line-height: 11pt;text-align: left;\">384</p></td></tr></tbody></table>",
	"3.6": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From the Console</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l218\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">VPC Network</span>.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">Firewall Rules</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">Firewall Rule </span>you want to modify.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Modify <span class=\"s15\">Source IP ranges </span>to specific <span class=\"s15\">IP</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><ol id=\"l219\"><li data-list-text=\"1.\"><p style=\"padding-top: 2pt;padding-left: 70pt;text-indent: -9pt;text-align: left;\">Update the Firewall rule with the new <span class=\"s15\">SOURCE_RANGE </span>from the below command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute firewall-rules update FirewallName --allow=[PROTOCOL[:PORT[-PORT]],...] --source-ranges=[CIDR_RANGE,...]</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">All Secure Shell (SSH) connections from outside of the network to the concerned VPC(s) will be blocked. There could be a business need where SSH access is required from outside of the network to access resources associated with the VPC. In that case, specific source IP(s) should be mentioned in firewall rules to white-list access to SSH port for the concerned VPC(s).</p></li></ol>",
	"3.7": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From the Console</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l224\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">VPC Network</span>.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">Firewall Rules</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">Firewall Rule </span>to be modified.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Modify <span class=\"s15\">Source IP ranges </span>to specific <span class=\"s15\">IP</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><ol id=\"l225\"><li data-list-text=\"1.\"><p style=\"padding-top: 2pt;padding-left: 70pt;text-indent: -9pt;text-align: left;\">Update RDP Firewall rule with new <span class=\"s15\">SOURCE_RANGE </span>from the below command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute firewall-rules update FirewallName --allow=[PROTOCOL[:PORT[-PORT]],...] --source-ranges=[CIDR_RANGE,...]</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">All Remote Desktop Protocol (RDP) connections from outside of the network to the concerned VPC(s) will be blocked. There could be a business need where secure shell access is required from outside of the network to access resources associated with the VPC. In that case, specific source IP(s) should be mentioned in firewall rules to white-list access to RDP port for the concerned VPC(s).</p></li></ol>",
	"3.8": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l230\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the VPC network GCP Console visiting</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">https://console.cloud.google.com/networking/networks/list</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the name of a subnet, The <span class=\"s15\">Subnet details </span>page displays.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">EDIT </span>button.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Set <span class=\"s15\">Flow Logs </span>to <span class=\"s15\">On</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click Save.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">To set Private Google access for a network subnet, run the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute networks subnets update [SUBNET_NAME] --region [REGION] --enable-flow-logs</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Standard pricing for Stackdriver Logging, BigQuery, or Cloud Pub/Sub applies. VPC Flow Logs generation will be charged starting in GA as described in reference: https://cloud.google.com/vpc/</p>",
	"3.9": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">If the TargetSSLProxy or TargetHttpsProxy does not have an SSL policy configured, create a new SSL policy. Otherwise, modify the existing insecure policy.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l237\"><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Navigate to the <span class=\"s15\">SSL Policies </span><a href=\"https://console.cloud.google.com/net-security/sslpolicies\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://console.cloud.google.com/net-security/sslpolicies\" target=\"_blank\">https://console.cloud.google.com/net-security/sslpolicies</a></p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the name of the insecure policy to go to its <span class=\"s15\">SSL policy details </span>page.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">EDIT</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Set <span class=\"s15\">Minimum TLS version </span>to <span class=\"s15\">TLS 1.2</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Set <span class=\"s15\">Profile </span>to <span class=\"s15\">Modern </span>or <span class=\"s15\">Restricted</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Alternatively, if teh user selects the profile <span class=\"s15\">Custom</span>, make sure that the following features are disabled:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">TLS_RSA_WITH_AES_128_GCM_SHA256 TLS_RSA_WITH_AES_256_GCM_SHA384 TLS_RSA_WITH_AES_128_CBC_SHA TLS_RSA_WITH_AES_256_CBC_SHA TLS_RSA_WITH_3DES_EDE_CBC_SHA</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l238\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">For each insecure SSL policy, update it to use secure cyphers:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute ssl-policies update NAME [--profile COMPATIBLE|MODERN|RESTRICTED|CUSTOM] --min-tls-version 1.2 [--custom-features FEATURES]</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">If the target proxy has a GCP default SSL policy, use the following command corresponding to the proxy type to update it.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute target-ssl-proxies update TARGET_SSL_PROXY_NAME --ssl-policy SSL_POLICY_NAME</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute target-https-proxies update TARGET_HTTPS_POLICY_NAME --ssl-policy SSL_POLICY_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Creating more secure SSL policies can prevent clients using older TLS versions from establishing a connection.</p>",
	"4.1": "<h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l244\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">VM instances </span><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/instances</a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the instance name to go to its <span class=\"s15\">VM instance details </span>page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">STOP </span>and then click <span class=\"s15\">EDIT</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Under the section <span class=\"s15\">Service Account</span>, select a service account other that the default Compute Engine service account. You may first need to create a new service account.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save </span>and then click <span class=\"s15\">START</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l245\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Stop the instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances stop INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Update the instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances set-service-account INSTANCE_NAME --service-account=SERVICE_ACCOUNT</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"3.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Restart the instance:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances start INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">None.</p>",
	"4.2": "<h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l251\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">VM instances </span><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/instances</a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the impacted VM instance.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">If the instance is not stopped, click the <span class=\"s15\">Stop </span>button. Wait for the instance to be stopped.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Next, click the <span class=\"s15\">Edit </span>button.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Service Account </span>section.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select a different service account or ensure that <span class=\"s15\">Allow full access to all Cloud APIs </span>is not selected.</p></li><li data-list-text=\"7.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">Save </span>button to save your changes and then click <span class=\"s15\">START</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l252\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Stop the instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances stop INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Update the instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances set-service-account INSTANCE_NAME --service-account=SERVICE_ACCOUNT --scopes [SCOPE1, SCOPE2...]</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"3.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Restart the instance:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances start INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">In order to change service account or scope for an instance, it needs to be stopped.</p>",
	"4.3": "<h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l258\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">VM instances </span><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/instances</a>. It will list all the instances in your project.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the name of the Impacted instance</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit </span>in the toolbar</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Under SSH Keys, go to the <span class=\"s15\">Block project-wide SSH keys </span>checkbox</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">To block users with project-wide SSH keys from connecting to this instance, select</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;text-align: left;\">Block project-wide SSH keys</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save </span>at the bottom of the page</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Repeat steps for every impacted Instance</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Block project-wide public SSH keys, set the metadata value to <span class=\"s15\">TRUE</span>:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances add-metadata INSTANCE_NAME --metadata block-project-ssh-keys=TRUE</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Users already having Project-wide ssh key pairs and using third party SSH clients will lose access to the impacted Instances. For Project users using gcloud or GCP Console based SSH option, no manual key creation and distribution is required and will be handled by GCE (Google Compute Engine) itself. To access Instance using third party SSH clients Instance specific SSH key pairs need to be created and distributed to the required users.</p>",
	"4.4": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l263\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/compute/metadata\" class=\"s4\" target=\"_blank\">Go to the VM compute metadata page by visiting: </a><a href=\"https://console.cloud.google.com/compute/metadata\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/metadata</a><a href=\"https://console.cloud.google.com/compute/metadata\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Add a metadata entry where the key is <span class=\"s15\">enable-oslogin </span>and the value is <span class=\"s15\">TRUE</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save </span>to apply the changes.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">For every instances that overrides the project setting, go to the <span class=\"s15\">VM Instances </span><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">page at </a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/instances</a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the name of the instance on which you want to remove the metadata value.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">At the top of the instance details page, click <span class=\"s15\">Edit </span>to edit the instance settings.</p></li><li data-list-text=\"8.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Under <span class=\"s15\">Custom metadata</span>, remove any entry with key <span class=\"s15\">enable-oslogin </span>and the value is <span class=\"s15\">FALSE</span></p></li><li data-list-text=\"9.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">At the bottom of the instance details page, click <span class=\"s15\">Save </span>to apply your changes to the instance.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l264\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure oslogin on the project:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute project-info add-metadata --metadata enable-oslogin=TRUE</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Remove instance metadata that overrides the project setting.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances remove-metadata INSTANCE_NAME --keys=enable-oslogin</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\"><a href=\"https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication\" class=\"s4\" target=\"_blank\">Optionally, you can enable two factor authentication fir OS login. For more information, see: </a><a href=\"https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication\" class=\"a\" target=\"_blank\">https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication</a><a href=\"https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication\" class=\"s4\" target=\"_blank\">.</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Enabling OS Login on project disables metadata-based SSH key configurations on all instances from a project. Disabling OS Login restores SSH keys that you have configured in project or instance meta-data.</p>",
	"4.5": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l269\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Login to Google Cloud console</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to Computer Engine</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to VM instances</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click on the Specific VM</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">EDIT</span></p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Unselect <span class=\"s15\">Enable connecting to serial ports </span>below <span class=\"s15\">Remote access </span>block.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save</span></p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Use the below command to disable</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances add-metadata INSTANCE_NAME --zone=ZONE --metadata=serial-port-enable=false</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">or</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances add-metadata INSTANCE_NAME --zone=ZONE --metadata=serial-port-enable=0</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">You can prevent VMs from having serial port access enable by <span class=\"s15\">Disable VM serial port access </span>organization policy:</p><p style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\"><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/compute-disableSerialPortAccess\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/compute-disableSerialPortAccess</a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/compute-disableSerialPortAccess\" class=\"s4\" target=\"_blank\">.</a></p>",
	"4.6": "<h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 113%;text-align: left;\">You only edit the <span class=\"s15\">canIpForward </span>setting at instance creation time. Therefore, you need to delete the instance and create a new one where <span class=\"s15\">canIpForward </span>is set to <span class=\"s15\">false</span>.</p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l274\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">VM Instances </span><a href=\"https://pantheon.corp.google.com/compute/instances\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://pantheon.corp.google.com/compute/instances\" class=\"a\" target=\"_blank\">https://pantheon.corp.google.com/compute/instances</a><a href=\"https://pantheon.corp.google.com/compute/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select the <span class=\"s15\">VM Instance </span>you want to remediate.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click the <span class=\"s15\">Delete </span>button.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">On the 'VM Instances' page, click `CREATE INSTANCE'.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Create a new instance with the desired configuration. By default, the instance is configured to not allow IP forwarding.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l275\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Delete the instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances delete INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Create a new instance to replace it, with <span class=\"s15\">IP forwarding </span>set to <span class=\"s15\">Off</span></p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances create</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Deleting instance(s) acting as routers/packet forwarders may break the network connectivity.</p>",
	"4.7": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 117%;text-align: left;\">Currently there is no way to update the encryption of an existing disk. Therefore you should create a new disk with <span class=\"s15\">Encryption </span>set to <span class=\"s15\">Customer supplied</span>.</p><h4 style=\"padding-left: 61pt;text-indent: 0pt;line-height: 14pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l281\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to Compute Engine <span class=\"s15\">Disks </span><a href=\"https://console.cloud.google.com/compute/disks\" class=\"s4\" target=\"_blank\">by visiting: </a><a href=\"https://console.cloud.google.com/compute/disks\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/disks</a><a href=\"https://console.cloud.google.com/compute/disks\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">CREATE DISK</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Set <span class=\"s15\">Encryption type </span>to <span class=\"s15\">Customer supplied</span>,</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Provide the <span class=\"s15\">Key </span>in the box.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select <span class=\"s15\">Wrapped key</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Create</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">In the gcloud compute tool, encrypt a disk using the --csek-key-file flag during instance creation. If you are using an RSA-wrapped key, use the gcloud beta component:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud (beta) compute instances create INSTANCE_NAME --csek-key-file</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">&lt;example-file.json&gt;</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">To encrypt a standalone persistent disk:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud (beta) compute disks create DISK_NAME --csek-key-file &lt;example-file.json&gt;</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">If you lose your encryption key, you will not be able to recover the data.</p>",
	"4.8": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">To be able turn on <span class=\"s15\">Shielded VM </span>on an instance, your instance must use an image with Shielded VM support.</p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l286\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">VM instances </span><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/instances</a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the instance name to see its <span class=\"s15\">VM instance details </span>page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">STOP </span>to stop the instance.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">When the instance has stopped, click <span class=\"s15\">EDIT</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the Shielded VM section, select <span class=\"s15\">Turn on vTPM </span>and <span class=\"s15\">Turn on Integrity Monitoring</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Optionally, if you do not use any custom or unsigned drivers on the instance, also select <span class=\"s15\">Turn on Secure Boot</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click the <span class=\"s15\">Save </span>button to modify the instance and then click <span class=\"s15\">START </span>to restart it.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">You can only enable Shielded VM options on instances that have Shielded VM support. For a list of Shielded VM public images, run the gcloud compute images list command with the following flags:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute images list --project gce-uefi-images --no-standard-images</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l287\"><li data-list-text=\"1.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Stop the instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances stop INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Update the instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances update INSTANCE_NAME --shielded-vtpm --shielded-vm-integrity-monitoring</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"3.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Optionally, if you do not use any custom or unsigned drivers on the instance, also turn on secure boot.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances update INSTANCE_NAME --shielded-vm-secure-boot</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"4.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Restart the instance:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances start INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">You can ensure that all new VMs will be created with Shielded VM enabled by setting up an Organization Policy to for <span class=\"s15\">Shielded VM </span><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/compute-requireShieldedVm\" class=\"s4\" target=\"_blank\">at </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/compute-requireShieldedVm\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/compute-requireShieldedVm</a><a href=\"https://cloud.google.com/security/shielded-cloud/shielded-vm#organization-policy-constraint\" class=\"s4\" target=\"_blank\">. Learn more at: </a><a href=\"https://cloud.google.com/security/shielded-cloud/shielded-vm#organization-policy-constraint\" class=\"a\" target=\"_blank\">https://cloud.google.com/security/shielded-cloud/shielded-vm#organization-policy-constraint</a><a href=\"https://cloud.google.com/security/shielded-cloud/shielded-vm#organization-policy-constraint\" class=\"s4\" target=\"_blank\">.</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">None.</p>",
	"4.9": "<h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l292\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the <span class=\"s15\">VM instances </span><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">page by visiting: </a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/compute/instances</a><a href=\"https://console.cloud.google.com/compute/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the instance name to go the the <span class=\"s15\">Instance detail page</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">For each Network interface, ensure that <span class=\"s15\">External IP </span>is set to <span class=\"s15\">None</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Done </span>and then click <span class=\"s15\">Save</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l293\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Describe the instance properties:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances describe INSTANCE_NAME --zone=ZONE</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Identify the access config name that contains the external IP address. This access config appears in the following format:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">networkInterfaces:</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">- accessConfigs:</p><p class=\"s15\" style=\"padding-left: 23pt;text-indent: -12pt;text-align: left;\">- kind: compute#accessConfig name: External NAT</p><p class=\"s15\" style=\"padding-left: 23pt;text-indent: 0pt;text-align: left;\">natIP: 130.211.181.55</p><p class=\"s15\" style=\"padding-left: 23pt;text-indent: 0pt;text-align: left;\">type: ONE_TO_ONE_NAT</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 79pt;text-indent: 0pt;text-align: left;\">2. Delete the access config.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud compute instances delete-access-config INSTANCE_NAME --zone=ZONE --access-config-name \"ACCESS_CONFIG_NAME\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">In the above example, the <span class=\"s15\">ACCESS_CONFIG_NAME </span>is <span class=\"s15\">External NAT</span>. The name of your access config might be different.</p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">You can configure the <span class=\"s15\">Define allowed external IPs for VM instances </span>Organization</p><p style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\"><a href=\"https://console.cloud.google.com/orgpolicies/compute-vmExternalIpAccess\" class=\"s4\" target=\"_blank\">Policy to prevent VMs from being configured with public IP addresses. Learn more at: </a><a href=\"https://console.cloud.google.com/orgpolicies/compute-vmExternalIpAccess\" target=\"_blank\">https://console.cloud.google.com/orgpolicies/compute-vmExternalIpAccess</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Removing the external IP address from your Compute instance may cause some applications to stop working.</p>",
	"4.10": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Add a line to the app.yaml file controlling the application which enforces secure connections. For example</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">handlers:</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">- url: /.*</p><p class=\"s15\" style=\"padding-left: 17pt;text-indent: 0pt;text-align: left;\">**secure: always** redirect_http_response_code: 301 script: auto</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">[https://cloud.google.com/appengine/docs/standard/python3/config/appref]</p><h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">All connections to appengine will automatically be redirected to the HTTPS endpoint ensuring that all connections are secured by TLS.</p>",
	"5.1": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l302\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to <span class=\"s15\">Storage browser </span><a href=\"https://console.cloud.google.com/storage/browser\" class=\"s4\" target=\"_blank\">by visiting </a><a href=\"https://console.cloud.google.com/storage/browser\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/storage/browser</a><a href=\"https://console.cloud.google.com/storage/browser\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the bucket name to go to its <span class=\"s15\">Bucket details </span>page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click on the <span class=\"s15\">Permissions </span>tab.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Delete </span>button in front of <span class=\"s15\">allUsers </span>and <span class=\"s15\">allAuthenticatedUsers </span>to remove that particular role assignment.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remove <span class=\"s15\">allUsers </span>and <span class=\"s15\">allAuthenticatedUsers </span>access.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gsutil iam ch -d allUsers gs://BUCKET_NAME</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">gsutil iam ch -d allAuthenticatedUsers gs://BUCKET_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">You can prevent Storage buckets from becoming publicly accessible by setting up the <span class=\"s15\">Domain restricted sharing </span><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-allowedPolicyMemberDomains\" class=\"s4\" target=\"_blank\">organization policy at: </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-allowedPolicyMemberDomains\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/iam-allowedPolicyMemberDomains </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/iam-allowedPolicyMemberDomains\" class=\"s4\" target=\"_blank\">.</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">No storage buckets would be publicly accessible. You would have to explicitly administer bucket access.</p>",
	"5.2": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l307\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/storage/browser\" class=\"s4\" target=\"_blank\">Open the Cloud Storage browser in the Google Cloud Console by visiting: </a><a href=\"https://console.cloud.google.com/storage/browser\" target=\"_blank\">https://console.cloud.google.com/storage/browser</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the list of buckets, click on the name of the desired bucket.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select the <span class=\"s15\">Permissions </span>tab near the top of the page.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the text box that starts with <span class=\"s15\">This bucket uses fine-grained access control...</span>, click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">In the pop-up menu that appears, select <span class=\"s15\">Uniform</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Use the on option in a uniformbucketlevelaccess set command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gsutil uniformbucketlevelaccess set on gs://BUCKET_NAME/</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 113%;text-align: left;\">You can set up an Organization Policy to enforce that any new bucket has uniform bucket level access enabled. Learn more at:</p><p style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\"><a href=\"https://cloud.google.com/storage/docs/setting-org-policies#uniform-bucket\">https://cloud.google.com/storage/docs/setting-org-policies#uniform-bucket</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">If you enable uniform bucket-level access, you revoke access from users who gain their access solely through object ACLs.</p><p style=\"padding-top: 10pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Certain Google Cloud services, such as Stackdriver, Cloud Audit Logs, and Datastore, cannot export to Cloud Storage buckets that have uniform bucket-level access enabled.</p>",
	"6.1.1": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l313\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the Cloud SQL Instances page in the Google Cloud Platform Console using</p><p class=\"s15\" style=\"padding-left: 97pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">https://console.cloud.google.com/sql/</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the instance to open its Overview page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select <span class=\"s15\">Access Control &gt; Users</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">more actions icon </span>for the user to be updated.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select <span class=\"s15\">Change password</span>, specify a <span class=\"s15\">new password</span>, and click <span class=\"s15\">OK</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Set a password to a MySql instance:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql users set-password [USER_NAME] [HOST] --instance=[INSTANCE_NAME] -</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">-password=[PASSWORD]</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Connection strings for administrative clients need to be reconfigured to use a password.</p>",
	"6.1.2": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l318\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting </a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the MySQL instance where the database flag needs to be enabled.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">local_infile </span>from the drop-down menu, and set its value to <span class=\"s15\">off</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l319\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">local_infile </span>database flag for every Cloud SQL Mysql database instance using the below command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 204%;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags local_infile=off Note :</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">This command will overwrite all database flags that were previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">Disabling <span class=\"s15\">local_infile </span>makes the server refuse local data loading by clients that have LOCAL enabled on the client side.</p>",
	"6.2.1": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l325\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting </a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the PostgreSQL instance where the database flag needs to be enabled.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">log_checkpoints </span>from the drop-down menu, and set its value.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l326\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">log_checkpoints </span>database flag for every Cloud SQL PosgreSQL database instance using the below command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 206%;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags log_checkpoints=on Note:</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">This command will overwrite all previously set database flags. To keep those</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"6.2.2": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l334\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the PostgreSQL instance for which you want to enable the database flag.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">log_connections </span>from the drop-down menu and set the value as <span class=\"s15\">on</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l335\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">log_connections </span>database flag for every Cloud SQL PosgreSQL database instance using the below command.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags log_connections=on</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">Note:</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">This command will overwrite all previously set database flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"6.2.3": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l340\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the PostgreSQL instance where the database flag needs to be enabled.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">log_disconnections </span>from the drop-down menu and set the value as <span class=\"s15\">on</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l341\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database Instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">log_disconnections </span>database flag for every Cloud SQL PosgreSQL database instance using the below command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags log_disconnections=on</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">Note: This command will overwrite all previously setdatabase flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"6.2.4": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l346\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the PostgreSQL instance where the database flag needs to be enabled.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">log_lock_waits </span>from the drop-down menu and set the value as <span class=\"s15\">on</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l347\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">log_lock_waits </span>database flag for every Cloud SQL PosgreSQL database instance using the below command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags log_lock_waits=on</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">Note: This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"6.2.5": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l352\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the PostgreSQL instance for which you want to enable the database flag.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">log_min_error_statement </span>from the drop-down menu and set appropriate value.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save </span>to save the changes.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l353\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database Instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">log_min_error_statement </span>database flag for every Cloud SQL PosgreSQL database instance using the below command.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags log_min_error_statement=&lt;DEBUG5|DEBUG4|DEBUG3|DEBUG2|DEBUG1|INFO|NOTICE|WARNI NG|ERROR|LOG|FATAL|PANIC&gt;</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">Note: This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p>",
	"6.2.6": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l358\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the PostgreSQL instance where the database flag needs to be enabled.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">log_temp_files </span>from the drop-down menu and set the value as <span class=\"s15\">0</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l359\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">log_temp_files </span>database flag for every Cloud SQL PosgreSQL database instance using the below command.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags log_temp_files=`0`</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">Note: This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"6.2.7": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l364\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances.</p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the PostgreSQL instance where the database flag needs to be enabled.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">log_min_duration_statement </span>from the drop-down menu and set a value of <span class=\"s15\">-1</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l365\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">log_min_duration_statement </span>flag for every Cloud SQL PosgreSQL database instance using the below command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags log_min_duration_statement=-1</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">Note: This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"6.3.1": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l373\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting </a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the SQL Server instance for which you want to enable to database flag.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: justify;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">cross db ownership chaining </span>from the drop-down menu, and set its value to <span class=\"s15\">off</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: justify;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: justify;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l374\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">gcloud sql instances list</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;\">``</p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">2. Configure the `cross db ownership chaining` database flag for every Cloud SQL SQL Server database instance using the below command:</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags \"cross db ownership chaining=off\"</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Note:</p><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p>",
	"6.3.2": "<h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l379\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting </a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the SQL Server instance for which you want to enable to database flag.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Scroll down to the <span class=\"s15\">Flags </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">To set a flag that has not been set on the instance before, click <span class=\"s15\">Add item</span>, choose the flag <span class=\"s15\">contained database authentication </span>from the drop-down menu, and set its value to <span class=\"s15\">off</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes under <span class=\"s15\">Flags </span>on the Overview page.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l380\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database Instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Configure the <span class=\"s15\">contained database authentication </span>database flag for every Cloud SQL SQL Server database instance using the below command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --database-flags \"contained database authentication=off\"</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">Note:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-left: 5pt;text-indent: 0pt;text-align: left;\">This command will overwrite all database flags previously set. To keep those and add new ones, , include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">When <span class=\"s15\">contained database authentication </span>is off (0) for the instance, contained databases cannot be created, or attached to the Database Engine.</p>",
	"6.4": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l385\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to </a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click on an instance name to see its configuration overview.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the left-side panel, select <span class=\"s15\">Connections</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">SSL connections </span>section, click <span class=\"s15\">Allow only SSL connections</span>.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Under <span class=\"s15\">Configure SSL server certificates </span>click <span class=\"s15\">Create new certificate</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Under <span class=\"s15\">Configure SSL client certificates </span>click <span class=\"s15\">Create a client certificate</span>.</p></li><li data-list-text=\"7.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Follow the instructions shown to learn how to connect to your instance.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">To enforce SSL encryption for an instance run the command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --require-ssl</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Note:</p><p class=\"s15\" style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 112%;text-align: left;\">RESTART <span class=\"p\">is required for type MySQL Generation 1 Instances (</span>backendType: FIRST_GEN<span class=\"p\">) to get this configuration in effect.</span></p><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">After enforcing SSL connection, existing client will not be able to communicate with SQL server unless configured with appropriate client-certificates to communicate to SQL database instance.</p>",
	"6.5": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l390\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting </a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the instance name to open its <span class=\"s15\">Instance details </span>page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Under the <span class=\"s15\">Configuration </span>section click <span class=\"s15\">Edit configurations</span></p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Under <span class=\"s15\">Configuration options </span>expand the <span class=\"s15\">Connectivity </span>section.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the <span class=\"s15\">delete </span>icon for the authorized network <span class=\"s15\">0.0.0.0/0</span>.</p></li><li data-list-text=\"6.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save </span>to update the instance.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Update the authorized network list by dropping off any addresses.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --authorized-networks=IP_ADDR1,IP_ADDR2...</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">To prevent new SQL instances from being configured to accept incoming connections from any IP addresses, set up a <span class=\"s15\">Restrict Authorized Networks on Cloud SQL instances </span><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictAuthorizedNetworks\" class=\"s4\" target=\"_blank\">Organization Policy at: </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictAuthorizedNetworks\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictAuthorizedNetworks</a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictAuthorizedNetworks\" class=\"s4\" target=\"_blank\">.</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">The Cloud SQL database instance would not be available to the world.</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p>",
	"6.6": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l395\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to the Cloud SQL Instances page in the Google Cloud Console: </a><a href=\"https://console.cloud.google.com/sql/instances\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Click the instance name to open its Instance details page.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Select the <span class=\"s15\">Connections </span>tab.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Deselect the <span class=\"s15\">Public IP </span>checkbox.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save </span>to update the instance.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l396\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">For every instance remove its public IP and assign a private IP instead:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud beta sql instances patch INSTANCE_NAME --network=VPC_NETWOR_NAME --no-assign-ip</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Confirm the changes using the following command::</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances describe INSTANCE_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">To prevent new SQL instances from getting configured with public IP addresses, set up a <span class=\"s15\">Restrict Public IP access on Cloud SQL instances </span><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictPublicIp\" class=\"s4\" target=\"_blank\">Organization policy at: </a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictPublicIp\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictPublicIp</a><a href=\"https://console.cloud.google.com/iam-admin/orgpolicies/sql-restrictPublicIp\" class=\"s4\" target=\"_blank\">.</a></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">Removing the public IP address on SQL instances may break some applications that relied on it for database connectivity.</p>",
	"6.7": "<h4 style=\"padding-top: 4pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l401\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\"><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">Go to the Cloud SQL Instances page in the Google Cloud Console by visiting </a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/sql/instances</a><a href=\"https://console.cloud.google.com/sql/instances\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the instance where the backups need to be configured.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Edit</span>.</p></li><li data-list-text=\"4.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the <span class=\"s15\">Backups </span>section, check `Enable automated backups', and choose a backup window.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">Save</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l402\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">List all Cloud SQL database instances using the following command:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances list</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Enable <span class=\"s15\">Automated backups </span>for every Cloud SQL database instance using the below command:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">gcloud sql instances patch INSTANCE_NAME --backup-start-time [HH:MM]</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;line-height: 113%;text-align: justify;\">The <span class=\"s15\">backup-start-time </span>parameter is specified in 24-hour time, in the UTC00 time zone, and specifies the start of a 4-hour backup window. Backups can start any time during the backup window.</p>",
	"7.1": "<h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">Remediation:</h4><h4 style=\"padding-top: 11pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Console:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l409\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Go to <span class=\"s15\">BigQuery </span><a href=\"https://console.cloud.google.com/bigquery\" class=\"s4\" target=\"_blank\">by visiting: </a><a href=\"https://console.cloud.google.com/bigquery\" class=\"a\" target=\"_blank\">https://console.cloud.google.com/bigquery</a><a href=\"https://console.cloud.google.com/bigquery\" class=\"s4\" target=\"_blank\">.</a></p></li><li data-list-text=\"2.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Select the dataset from 'Resources'.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click <span class=\"s15\">SHARE DATASET </span>near the right side of the window.</p></li><li data-list-text=\"4.\"><p style=\"padding-top: 4pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">Review each attached role.</p></li><li data-list-text=\"5.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Click the delete icon for each member <span class=\"s15\">allUsers </span>or <span class=\"s15\">allAuthenticatedUsers</span>. On the popup click <span class=\"s15\">Remove</span>.</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-left: 61pt;text-indent: 0pt;text-align: left;\">From Command Line:</h4><p style=\"text-indent: 0pt;text-align: left;\"><br></p><ol id=\"l410\"><li data-list-text=\"1.\"><p style=\"padding-left: 97pt;text-indent: -18pt;text-align: left;\">Retrieve the data set information:</p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">bq show --format=prettyjson PROJECT_ID:DATASET_NAME &gt; PATH_TO_FILE</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p></li><li data-list-text=\"2.\"><p style=\"padding-top: 5pt;padding-left: 97pt;text-indent: -18pt;text-align: left;\">In the access section of the JSON file, update the dataset information to remove all roles containing <span class=\"s15\">allUsers </span>or <span class=\"s15\">allAuthenticatedUsers</span>.</p></li><li data-list-text=\"3.\"><p style=\"padding-left: 97pt;text-indent: -18pt;line-height: 14pt;text-align: left;\">Update the dataset:</p></li></ol><p style=\"text-indent: 0pt;text-align: left;\"><br></p><p class=\"s15\" style=\"padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;\">bq update --source PATH_TO_FILE PROJECT_ID:DATASET_NAME</p><p style=\"padding-left: 55pt;text-indent: 0pt;text-align: left;\"></p><p style=\"text-indent: 0pt;text-align: left;\"><br></p><h4 style=\"padding-top: 5pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Prevention:</h4><p style=\"padding-top: 2pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">You can prevent Bigquery dataset from becoming publicly accessible by setting up the <span class=\"s15\">Domain restricted sharing </span>organization policy at: https://console.cloud.google.com/iam-admin/orgpolicies/iam-allowedPolicyMemberDomains .</p><h4 style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;text-align: left;\">Impact:</h4><p style=\"padding-top: 12pt;padding-left: 61pt;text-indent: 0pt;line-height: 114%;text-align: left;\">The dataset is not publicly accessible. Explicit modification of IAM privileges would be necessary to make them publicly accessible.</p>"
}
